<?xml version="1.0" encoding="UTF-8"?>
<itop_design version="3.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://rudnerbjoern.github.io/iTop-schema/3.2/itop_design.xsd">
    <!--
    * @copyright   Copyright (C) 2024-2025 BjÃ¶rn Rudner
    * @license     https://www.gnu.org/licenses/agpl-3.0.en.html
    -->
    <classes>
        <class id="ISMSAssetType" _delta="define">
            <parent>Typology</parent>
            <properties>
                <category>bizmodel,searchable,configmgmt</category>
                <abstract>false</abstract>
                <key_type>autoincrement</key_type>
                <db_table>ismsassettype</db_table>
                <db_key_field>id</db_key_field>
                <db_final_class_field />
                <naming>
                    <attributes>
                        <attribute id="name" />
                    </attributes>
                </naming>
                <style>
                    <icon>images/isms-assettype.svg</icon>
                </style>
                <reconciliation>
                    <attributes>
                        <attribute id="name" />
                    </attributes>
                </reconciliation>
                <uniqueness_rules>
                    <rule id="name">
                        <attributes>
                            <attribute id="name" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
            </properties>
            <fields>
                <field id="description" xsi:type="AttributeText">
                    <sql>description</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                    <format>html</format>
                </field>
                <field id="ismsassets_list" xsi:type="AttributeLinkedSet">
                    <linked_class>ISMSAsset</linked_class>
                    <ext_key_to_me>assettype_id</ext_key_to_me>
                    <edit_mode>add_only</edit_mode>
                    <count_min>0</count_min>
                    <count_max>0</count_max>
                    <duplicates />
                </field>
            </fields>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="name">
                            <rank>10</rank>
                        </item>
                        <item id="description">
                            <rank>20</rank>
                        </item>
                        <item id="ismsassets_list">
                            <rank>100</rank>
                        </item>
                    </items>
                </details>
                <default_search>
                    <items>
                        <item id="name">
                            <rank>10</rank>
                        </item>
                    </items>
                </default_search>
                <search>
                    <items>
                        <item id="name">
                            <rank>10</rank>
                        </item>
                        <item id="description">
                            <rank>20</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="description">
                            <rank>20</rank>
                        </item>
                    </items>
                </list>
            </presentation>
        </class>
        <class id="ISMSAsset" _delta="define">
            <parent>FunctionalCI</parent>
            <php_parent>
                <name>BR_isms\Extension\Framework\Model\_ISMSAsset</name>
                <file>src/_ISMSAsset.php</file>
            </php_parent>
            <properties>
                <category>bizmodel,searchable</category>
                <abstract>false</abstract>
                <db_table>ismsasset</db_table>
                <db_key_field>id</db_key_field>
                <key_type>autoincrement</key_type>
                <db_final_class_field />
                <naming>
                    <attributes>
                        <attribute id="ref" />
                        <attribute id="name" />
                    </attributes>
                </naming>
                <fields_semantic>
                    <state_attribute>status</state_attribute>
                </fields_semantic>
                <style>
                    <icon>images/isms-asset.svg</icon>
                </style>
                <reconciliation>
                    <attributes>
                        <attribute id="ref" />
                        <attribute id="name" />
                        <attribute id="org_id" />
                        <attribute id="organization_name" />
                    </attributes>
                </reconciliation>
                <indexes>
                    <index id="ref">
                        <attributes>
                            <attribute id="ref" />
                        </attributes>
                    </index>
                </indexes>
                <uniqueness_rules>
                    <rule id="ref">
                        <attributes>
                            <attribute id="ref" />
                        </attributes>
                        <is_blocking>false</is_blocking>
                    </rule>
                    <rule id="name">
                        <attributes>
                            <attribute id="org_id" />
                            <attribute id="name" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
                <obsolescence>
                    <condition><![CDATA[status='obsolete']]></condition>
                </obsolescence>
            </properties>
            <fields>
                <field id="ref" xsi:type="AttributeString">
                    <sql>ref</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="status" xsi:type="AttributeEnum">
                    <sql>status</sql>
                    <sort_type>rank</sort_type>
                    <values>
                        <value id="draft">
                            <code>draft</code>
                            <rank>10</rank>
                            <style>
                                <main_color>$ibo-lifecycle-new-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-new-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-plus-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="published">
                            <code>published</code>
                            <rank>20</rank>
                            <style>
                                <main_color>$ibo-lifecycle-active-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-active-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-check-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="obsolete">
                            <code>obsolete</code>
                            <rank>30</rank>
                            <style>
                                <main_color>$ibo-lifecycle-inactive-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-inactive-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-times-circle</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <default_value>draft</default_value>
                    <is_null_allowed>false</is_null_allowed>
                    <always_load_in_tables>true</always_load_in_tables>
                    <display_style>list</display_style>
                </field>
                <field id="category" xsi:type="AttributeEnum">
                    <sql>category</sql>
                    <sort_type>rank</sort_type>
                    <values>
                        <value id="primary">
                            <code>primary</code>
                            <rank>10</rank>
                        </value>
                        <value id="secondary">
                            <code>secondary</code>
                            <rank>20</rank>
                        </value>
                    </values>
                    <default_value>primary</default_value>
                    <is_null_allowed>false</is_null_allowed>
                    <always_load_in_tables>true</always_load_in_tables>
                    <display_style>radio_horizontal</display_style>
                </field>
                <field id="assettype_id" xsi:type="AttributeExternalKey">
                    <sql>assettype_id</sql>
                    <target_class>ISMSAssetType</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="assettype_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>assettype_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="assetowner_id" xsi:type="AttributeExternalKey">
                    <sql>assetowner_id</sql>
                    <target_class>Person</target_class>
                    <filter><![CDATA[SELECT Person WHERE org_id = :this->org_id]]></filter>
                    <dependencies>
                        <attribute id="org_id" />
                    </dependencies>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="assetowner_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>assetowner_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="assetguardian_id" xsi:type="AttributeExternalKey">
                    <sql>assetguardian_id</sql>
                    <target_class>Contact</target_class>
                    <filter><![CDATA[SELECT Contact WHERE org_id = :this->org_id]]></filter>
                    <dependencies>
                        <attribute id="org_id" />
                    </dependencies>
                    <is_null_allowed>true</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="assetguardian_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>assetguardian_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="assetusers" xsi:type="AttributeText">
                    <sql>assetusers</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="creation_date" xsi:type="AttributeDate">
                    <sql>creation_date</sql>
                    <default_value />
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="publish_date" xsi:type="AttributeDate">
                    <sql>publish_date</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="last_update" xsi:type="AttributeDateTime">
                    <sql>last_update</sql>
                    <default_value />
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <!-- Review interval in months (3/6/12/24), Default 12 -->
                <field id="review_interval_months" xsi:type="AttributeEnum" _delta="define">
                    <sql>review_interval_months</sql>
                    <values>
                        <value id="3">
                            <code>3</code>
                        </value>
                        <value id="6">
                            <code>6</code>
                        </value>
                        <value id="12">
                            <code>12</code>
                        </value>
                        <value id="24">
                            <code>24</code>
                        </value>
                    </values>
                    <is_null_allowed>false</is_null_allowed>
                    <display_style>list</display_style>
                    <sort_type>code</sort_type>
                </field>
                <field id="last_review" xsi:type="AttributeDate">
                    <sql>last_review</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="next_review" xsi:type="AttributeDate">
                    <sql>next_review</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="functionalcis_list" xsi:type="AttributeLinkedSetIndirect">
                    <linked_class>lnkFunctionalCiToAsset</linked_class>
                    <ext_key_to_me>asset_id</ext_key_to_me>
                    <ext_key_to_remote>functionalci_id</ext_key_to_remote>
                    <count_min>0</count_min>
                    <count_max>0</count_max>
                    <duplicates>false</duplicates>
                </field>
                <field id="supportingassets_list" xsi:type="AttributeLinkedSetIndirect">
                    <linked_class>lnkSupportingAssetToAsset</linked_class>
                    <ext_key_to_me>asset_id</ext_key_to_me>
                    <ext_key_to_remote>supportingasset_id</ext_key_to_remote>
                    <count_min>0</count_min>
                    <count_max>0</count_max>
                    <duplicates>false</duplicates>
                </field>
                <field id="supportedassets_list" xsi:type="AttributeLinkedSetIndirect">
                    <linked_class>lnkSupportingAssetToAsset</linked_class>
                    <ext_key_to_me>supportingasset_id</ext_key_to_me>
                    <ext_key_to_remote>asset_id</ext_key_to_remote>
                    <count_min>0</count_min>
                    <count_max>0</count_max>
                    <duplicates>false</duplicates>
                </field>
                <field id="risks_list" xsi:type="AttributeLinkedSetIndirect">
                    <linked_class>lnkISMSRiskToISMSAsset</linked_class>
                    <ext_key_to_me>asset_id</ext_key_to_me>
                    <ext_key_to_remote>risk_id</ext_key_to_remote>
                    <count_min>0</count_min>
                    <count_max>0</count_max>
                    <duplicates>false</duplicates>
                    <display_style>tab</display_style>
                </field>
                <field id="reviews_list" xsi:type="AttributeLinkedSet">
                    <linked_class>ISMSAssetReview</linked_class>
                    <ext_key_to_me>asset_id</ext_key_to_me>
                    <edit_mode>add_only</edit_mode>
                    <count_min>0</count_min>
                    <count_max>0</count_max>
                </field>
            </fields>
            <lifecycle>
                <stimuli>
                    <stimulus id="ev_publish" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_draft" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_obsolete" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_reopen" xsi:type="StimulusUserAction" />
                </stimuli>
                <states>
                    <state id="draft">
                        <flags>
                            <attribute id="ref">
                                <read_only />
                            </attribute>
                            <attribute id="creation_date">
                                <read_only />
                            </attribute>
                            <attribute id="publish_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_update">
                                <read_only />
                            </attribute>
                            <attribute id="last_review">
                                <read_only />
                            </attribute>
                            <attribute id="next_review">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_publish">
                                <target>published</target>
                                <actions>
                                    <action id="1">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">publish_date</param>
                                        </params>
                                    </action>
                                    <!-- done by event EVENT_DB_BEFORE_WRITE: EvtBeforeISMSAssetWrite
                                    <action id="9">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">last_update</param>
                                        </params>
                                    </action>
                                     -->
                                </actions>
                            </transition>
                        </transitions>
                    </state>
                    <state id="published">
                        <flags>
                            <attribute id="ref">
                                <read_only />
                            </attribute>
                            <attribute id="org_id">
                                <read_only />
                            </attribute>
                            <attribute id="name">
                                <read_only />
                            </attribute>
                            <attribute id="assetowner_id">
                                <read_only />
                            </attribute>
                            <attribute id="category">
                                <read_only />
                            </attribute>
                            <attribute id="assettype_id">
                                <read_only />
                            </attribute>
                            <attribute id="creation_date">
                                <read_only />
                            </attribute>
                            <attribute id="publish_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_update">
                                <read_only />
                            </attribute>
                            <attribute id="last_review">
                                <read_only />
                            </attribute>
                            <attribute id="next_review">
                                <read_only />
                            </attribute>
                            <attribute id="rm_confidentiality">
                                <mandatory />
                                <read_only />
                            </attribute>
                            <attribute id="rm_integrity">
                                <mandatory />
                                <read_only />
                            </attribute>
                            <attribute id="rm_availability">
                                <mandatory />
                                <read_only />
                            </attribute>
                            <attribute id="rm_authenticity">
                                <mandatory />
                                <read_only />
                            </attribute>
                            <attribute id="rm_nonrepudiation">
                                <mandatory />
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_draft">
                                <target>draft</target>
                                <actions>
                                    <action id="1">
                                        <verb>Reset</verb>
                                        <params>
                                            <param xsi:type="attcode">publish_date</param>
                                        </params>
                                    </action>
                                    <!-- done by event EVENT_DB_BEFORE_WRITE: EvtBeforeISMSAssetWrite
                                    <action id="9">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">last_update</param>
                                        </params>
                                    </action>
                                -->
                                </actions>
                            </transition>
                            <transition id="ev_obsolete">
                                <target>obsolete</target>
                                <actions>
                                    <!-- done by event EVENT_DB_BEFORE_WRITE: EvtBeforeISMSAssetWrite
                                    <action id="9">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">last_update</param>
                                        </params>
                                    </action>
                                -->
                                </actions>
                            </transition>
                        </transitions>
                    </state>
                    <state id="obsolete">
                        <flags>
                            <attribute id="ref">
                                <read_only />
                            </attribute>
                            <attribute id="org_id">
                                <read_only />
                            </attribute>
                            <attribute id="name">
                                <read_only />
                            </attribute>
                            <attribute id="status">
                                <read_only />
                            </attribute>
                            <attribute id="assetowner_id">
                                <read_only />
                            </attribute>
                            <attribute id="assetguardian_id">
                                <read_only />
                            </attribute>
                            <attribute id="assetusers">
                                <read_only />
                            </attribute>
                            <attribute id="category">
                                <read_only />
                            </attribute>
                            <attribute id="assettype_id">
                                <read_only />
                            </attribute>
                            <attribute id="description">
                                <read_only />
                            </attribute>
                            <attribute id="rm_confidentiality">
                                <read_only />
                            </attribute>
                            <attribute id="rm_integrity">
                                <read_only />
                            </attribute>
                            <attribute id="rm_availability">
                                <read_only />
                            </attribute>
                            <attribute id="rm_authenticity">
                                <read_only />
                            </attribute>
                            <attribute id="rm_nonrepudiation">
                                <read_only />
                            </attribute>
                            <attribute id="creation_date">
                                <read_only />
                            </attribute>
                            <attribute id="publish_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_update">
                                <read_only />
                            </attribute>
                            <attribute id="last_review">
                                <read_only />
                            </attribute>
                            <attribute id="next_review">
                                <read_only />
                            </attribute>
                            <attribute id="functionalcis_list">
                                <read_only />
                            </attribute>
                            <attribute id="supportingassets_list">
                                <read_only />
                            </attribute>
                            <attribute id="supportedassets_list">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_reopen">
                                <target>draft</target>
                                <actions>
                                    <action id="1">
                                        <verb>Reset</verb>
                                        <params>
                                            <param xsi:type="attcode">publish_date</param>
                                        </params>
                                    </action>
                                    <!-- done by event EVENT_DB_BEFORE_WRITE: EvtBeforeISMSAssetWrite
                                    <action id="9">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">last_update</param>
                                        </params>
                                    </action>
                                -->
                                </actions>
                            </transition>
                        </transitions>
                    </state>
                </states>
            </lifecycle>
            <relations>
                <relation id="impacts">
                    <neighbours>
                        <neighbour id="ismsasset">
                            <query_down><![CDATA[SELECT ISMSAsset AS down JOIN lnkSupportingAssetToAsset AS lnk ON lnk.asset_id = down.id WHERE lnk.supportingasset_id = :this->id]]></query_down>
                            <query_up><![CDATA[SELECT ISMSAsset AS up JOIN lnkSupportingAssetToAsset AS lnk ON lnk.supportingasset_id = up.id WHERE lnk.asset_id = :this->id]]></query_up>
                        </neighbour>
                        <neighbour id="ismsrisk">
                            <query_up><![CDATA[SELECT ISMSRisk AS up JOIN lnkISMSRiskToISMSAsset AS lnk ON lnk.risk_id = up.id WHERE lnk.asset_id = :this->id]]></query_up>
                            <query_down><![CDATA[SELECT ISMSRisk AS down WHERE 1 = 0]]></query_down>
                        </neighbour>
                        <neighbour id="functionalci">
                            <query_up><![CDATA[SELECT FunctionalCI AS up JOIN lnkFunctionalCiToAsset AS lnk ON lnk.functionalci_id = up.id WHERE lnk.asset_id = :this->id]]></query_up>
                            <query_down><![CDATA[SELECT FunctionalCI AS down WHERE 1 = 0]]></query_down>
                        </neighbour>
                    </neighbours>
                </relation>
            </relations>
            <event_listeners>
                <event_listener id="EvtSetInitialISMSAssetAttributeFlags">
                    <event>EVENT_DB_SET_INITIAL_ATTRIBUTES_FLAGS</event>
                    <rank>10</rank>
                    <callback>EvtSetInitialISMSAssetAttributeFlags</callback>
                </event_listener>
                <event_listener id="EvtSetISMSAssetAttributeFlags">
                    <event>EVENT_DB_SET_ATTRIBUTES_FLAGS</event>
                    <rank>10</rank>
                    <callback>EvtSetISMSAssetAttributeFlags</callback>
                </event_listener>
                <event_listener id="EvtBeforeISMSAssetWrite">
                    <event>EVENT_DB_BEFORE_WRITE</event>
                    <rank>10</rank>
                    <callback>EvtBeforeISMSAssetWrite</callback>
                </event_listener>
            </event_listeners>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="col:col0">
                            <rank>10</rank>
                            <items>
                                <item id="fieldset:Server:baseinfo">
                                    <rank>10</rank>
                                    <items>
                                        <item id="name">
                                            <rank>10</rank>
                                        </item>
                                        <item id="org_id">
                                            <rank>20</rank>
                                        </item>
                                        <item id="status">
                                            <rank>30</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSAsset:Contacts">
                                    <rank>20</rank>
                                    <items>
                                        <item id="assetowner_id">
                                            <rank>10</rank>
                                        </item>
                                        <item id="assetguardian_id">
                                            <rank>20</rank>
                                        </item>
                                        <item id="assetusers">
                                            <rank>30</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="col:col1">
                            <rank>20</rank>
                            <items>
                                <item id="fieldset:Server:moreinfo">
                                    <rank>10</rank>
                                    <items>
                                        <item id="category">
                                            <rank>10</rank>
                                        </item>
                                        <item id="assettype_id">
                                            <rank>20</rank>
                                        </item>
                                        <item id="description">
                                            <rank>30</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:FunctionalCI:RiskManagement">
                                    <rank>20</rank>
                                    <items>
                                        <item id="rm_confidentiality">
                                            <rank>10</rank>
                                        </item>
                                        <item id="rm_integrity">
                                            <rank>20</rank>
                                        </item>
                                        <item id="rm_availability">
                                            <rank>30</rank>
                                        </item>
                                        <item id="rm_authenticity">
                                            <rank>40</rank>
                                        </item>
                                        <item id="rm_nonrepudiation">
                                            <rank>50</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSReview:Reviews">
                                    <rank>30</rank>
                                    <items>
                                        <item id="review_interval_months">
                                            <rank>10</rank>
                                        </item>
                                        <item id="last_review">
                                            <rank>20</rank>
                                        </item>
                                        <item id="next_review">
                                            <rank>30</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="col:col2">
                            <rank>30</rank>
                            <items>
                                <item id="fieldset:Server:Date">
                                    <rank>10</rank>
                                    <items>
                                        <item id="creation_date">
                                            <rank>10</rank>
                                        </item>
                                        <item id="publish_date">
                                            <rank>20</rank>
                                        </item>
                                        <item id="last_update">
                                            <rank>30</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="supportingassets_list">
                            <rank>100</rank>
                        </item>
                        <item id="supportedassets_list">
                            <rank>110</rank>
                        </item>
                        <item id="functionalcis_list">
                            <rank>120</rank>
                        </item>
                        <item id="risks_list">
                            <rank>130</rank>
                        </item>
                        <item id="reviews_list">
                            <rank>140</rank>
                        </item>
                    </items>
                </details>
                <default_search>
                    <items>
                        <item id="ref">
                            <rank>10</rank>
                        </item>
                        <item id="name">
                            <rank>20</rank>
                        </item>
                        <item id="assetowner_id">
                            <rank>30</rank>
                        </item>
                        <item id="status">
                            <rank>40</rank>
                        </item>
                        <item id="category">
                            <rank>50</rank>
                        </item>
                        <item id="assettype_id">
                            <rank>60</rank>
                        </item>
                        <item id="org_id">
                            <rank>70</rank>
                        </item>
                    </items>
                </default_search>
                <search>
                    <items>
                        <item id="org_id">
                            <rank>10</rank>
                        </item>
                        <item id="status">
                            <rank>20</rank>
                        </item>
                        <item id="category">
                            <rank>30</rank>
                        </item>
                        <item id="assettype_id">
                            <rank>40</rank>
                        </item>
                        <item id="assetowner_id">
                            <rank>50</rank>
                        </item>
                        <item id="description">
                            <rank>60</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="org_id">
                            <rank>20</rank>
                        </item>
                        <item id="status">
                            <rank>30</rank>
                        </item>
                        <item id="category">
                            <rank>40</rank>
                        </item>
                        <item id="assettype_id">
                            <rank>50</rank>
                        </item>
                        <item id="assetowner_id">
                            <rank>60</rank>
                        </item>
                    </items>
                </list>
                <summary>
                    <items>
                        <item id="status">
                            <rank>10</rank>
                        </item>
                        <item id="category">
                            <rank>20</rank>
                        </item>
                        <item id="assettype_id">
                            <rank>30</rank>
                        </item>
                        <item id="assetowner_id">
                            <rank>40</rank>
                        </item>
                    </items>
                </summary>
            </presentation>
        </class>
        <class id="lnkSupportingAssetToAsset" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <properties>
                <is_link>1</is_link>
                <category>bizmodel</category>
                <abstract>false</abstract>
                <key_type>autoincrement</key_type>
                <db_table>lnksupportingassettoasset</db_table>
                <db_key_field>id</db_key_field>
                <db_final_class_field />
                <naming>
                    <attributes>
                        <attribute id="supportingasset_id" />
                        <attribute id="asset_id" />
                    </attributes>
                </naming>
                <reconciliation>
                    <attributes>
                        <attribute id="supportingasset_id" />
                        <attribute id="asset_id" />
                    </attributes>
                </reconciliation>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="supportingasset_id" />
                            <attribute id="asset_id" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
            </properties>
            <fields>
                <field id="supportingasset_id" xsi:type="AttributeExternalKey">
                    <sql>supportingasset_id</sql>
                    <target_class>ISMSAsset</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="supportingasset_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>supportingasset_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="asset_id" xsi:type="AttributeExternalKey">
                    <sql>asset_id</sql>
                    <target_class>ISMSAsset</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="asset_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>asset_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
            </fields>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="supportingasset_id">
                            <rank>10</rank>
                        </item>
                        <item id="asset_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </details>
                <search>
                    <items>
                        <item id="supportingasset_id">
                            <rank>10</rank>
                        </item>
                        <item id="asset_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="supportingasset_id">
                            <rank>20</rank>
                        </item>
                        <item id="asset_id">
                            <rank>30</rank>
                        </item>
                    </items>
                </list>
            </presentation>
        </class>
        <class id="lnkFunctionalCiToAsset" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <properties>
                <is_link>1</is_link>
                <category>bizmodel</category>
                <abstract>false</abstract>
                <key_type>autoincrement</key_type>
                <db_table>lnkfunctionalcitoasset</db_table>
                <db_key_field>id</db_key_field>
                <db_final_class_field />
                <naming>
                    <attributes>
                        <attribute id="functionalci_id" />
                        <attribute id="asset_id" />
                    </attributes>
                </naming>
                <reconciliation>
                    <attributes>
                        <attribute id="functionalci_id" />
                        <attribute id="asset_id" />
                    </attributes>
                </reconciliation>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="functionalci_id" />
                            <attribute id="asset_id" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
            </properties>
            <fields>
                <field id="functionalci_id" xsi:type="AttributeExternalKey">
                    <sql>functionalci_id</sql>
                    <target_class>FunctionalCI</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                </field>
                <field id="functionalci_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>functionalci_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="asset_id" xsi:type="AttributeExternalKey">
                    <sql>asset_id</sql>
                    <target_class>ISMSAsset</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                </field>
                <field id="asset_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>asset_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
            </fields>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="functionalci_id">
                            <rank>10</rank>
                        </item>
                        <item id="asset_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </details>
                <search>
                    <items>
                        <item id="functionalci_id">
                            <rank>10</rank>
                        </item>
                        <item id="asset_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="functionalci_id">
                            <rank>20</rank>
                        </item>
                        <item id="asset_id">
                            <rank>30</rank>
                        </item>
                    </items>
                </list>
            </presentation>
        </class>
        <class id="FunctionalCI" _delta="must_exist">
            <relations>
                <relation id="impacts">
                    <neighbours>
                        <neighbour id="ismsasset">
                            <direction>down</direction>
                            <query_down><![CDATA[SELECT ISMSAsset AS down JOIN lnkFunctionalCiToAsset AS lnk ON lnk.asset_id = down.id WHERE lnk.functionalci_id = :this->id]]></query_down>
                        </neighbour>
                    </neighbours>
                </relation>
            </relations>
        </class>
        <class id="ISMSRisk" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <php_parent>
                <name>BR_isms\Extension\Framework\Model\_ISMSRisk</name>
                <file>src/_ISMSRisk.php</file>
            </php_parent>
            <properties>
                <category>bizmodel,searchable</category>
                <abstract>false</abstract>
                <db_table>ismsrisk</db_table>
                <db_key_field>id</db_key_field>
                <key_type>autoincrement</key_type>
                <db_final_class_field />
                <naming>
                    <attributes>
                        <attribute id="ref" />
                        <attribute id="name" />
                    </attributes>
                </naming>
                <fields_semantic>
                    <state_attribute>status</state_attribute>
                </fields_semantic>
                <style>
                    <icon>images/isms-risk.svg</icon>
                </style>
                <reconciliation>
                    <attributes>
                        <attribute id="ref" />
                        <attribute id="name" />
                        <attribute id="org_id" />
                        <attribute id="organization_name" />
                    </attributes>
                </reconciliation>
                <indexes>
                    <index id="ref">
                        <attributes>
                            <attribute id="ref" />
                        </attributes>
                    </index>
                </indexes>
                <uniqueness_rules>
                    <rule id="ref">
                        <attributes>
                            <attribute id="ref" />
                        </attributes>
                        <is_blocking>false</is_blocking>
                    </rule>
                    <rule id="name">
                        <attributes>
                            <attribute id="org_id" />
                            <attribute id="name" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
                <obsolescence>
                    <condition><![CDATA[status='obsolete']]></condition>
                </obsolescence>
            </properties>
            <fields>
                <field id="ref" xsi:type="AttributeString">
                    <sql>ref</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="name" xsi:type="AttributeString">
                    <sql>name</sql>
                    <default_value />
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="org_id" xsi:type="AttributeExternalKey">
                    <sql>org_id</sql>
                    <target_class>Organization</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                </field>
                <field id="organization_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>org_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="status" xsi:type="AttributeEnum">
                    <sql>status</sql>
                    <sort_type>rank</sort_type>
                    <values>
                        <value id="draft">
                            <code>draft</code>
                            <rank>10</rank>
                            <style>
                                <main_color>$ibo-lifecycle-new-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-new-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-plus-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="published">
                            <code>published</code>
                            <rank>20</rank>
                            <style>
                                <main_color>$ibo-lifecycle-active-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-active-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-check-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="obsolete">
                            <code>obsolete</code>
                            <rank>30</rank>
                            <style>
                                <main_color>$ibo-lifecycle-inactive-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-inactive-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-times-circle</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <default_value>draft</default_value>
                    <is_null_allowed>false</is_null_allowed>
                    <always_load_in_tables>true</always_load_in_tables>
                    <display_style>list</display_style>
                </field>
                <field id="riskowner_id" xsi:type="AttributeExternalKey">
                    <sql>riskowner_id</sql>
                    <target_class>Person</target_class>
                    <filter><![CDATA[SELECT Person WHERE org_id = :this->org_id]]></filter>
                    <dependencies>
                        <attribute id="org_id" />
                    </dependencies>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="riskowner_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>riskowner_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="creation_date" xsi:type="AttributeDate">
                    <sql>creation_date</sql>
                    <default_value />
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="publish_date" xsi:type="AttributeDate">
                    <sql>publish_date</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="last_update" xsi:type="AttributeDateTime">
                    <sql>last_update</sql>
                    <default_value />
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <!-- Review interval in months (3/6/12/24), Default 12 -->
                <field id="review_interval_months" xsi:type="AttributeEnum" _delta="define">
                    <sql>review_interval_months</sql>
                    <values>
                        <value id="3">
                            <code>3</code>
                        </value>
                        <value id="6">
                            <code>6</code>
                        </value>
                        <value id="12">
                            <code>12</code>
                        </value>
                        <value id="24">
                            <code>24</code>
                        </value>
                    </values>
                    <is_null_allowed>false</is_null_allowed>
                    <display_style>list</display_style>
                    <sort_type>code</sort_type>
                </field>
                <field id="last_review" xsi:type="AttributeDate">
                    <sql>last_review</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="next_review" xsi:type="AttributeDate">
                    <sql>next_review</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="description" xsi:type="AttributeText">
                    <sql>description</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="assets_list" xsi:type="AttributeLinkedSetIndirect">
                    <linked_class>lnkISMSRiskToISMSAsset</linked_class>
                    <ext_key_to_me>risk_id</ext_key_to_me>
                    <ext_key_to_remote>asset_id</ext_key_to_remote>
                    <count_min>0</count_min>
                    <count_max>0</count_max>
                    <duplicates>false</duplicates>
                </field>
                <field id="risk_category" xsi:type="AttributeEnum">
                    <sql>risk_category</sql>
                    <values>
                        <value id="security">
                            <code>security</code>
                            <rank>10</rank>
                        </value>
                        <value id="privacy">
                            <code>privacy</code>
                            <rank>20</rank>
                        </value>
                        <value id="compliance">
                            <code>compliance</code>
                            <rank>30</rank>
                        </value>
                        <value id="operational">
                            <code>operational</code>
                            <rank>40</rank>
                        </value>
                        <value id="strategic">
                            <code>strategic</code>
                            <rank>50</rank>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <default_value>security</default_value>
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="risk_cause" xsi:type="AttributeText">
                    <sql>risk_cause</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="risk_event" xsi:type="AttributeText">
                    <sql>risk_event</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="risk_consequence" xsi:type="AttributeText">
                    <sql>risk_consequence</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="pre_likelihood" xsi:type="AttributeEnum">
                    <sql>pre_likelihood</sql>
                    <values>
                        <value id="1">
                            <code>1</code>
                            <rank>10</rank>
                            <style>
                                <main_color>rgb(232,245,233)</main_color>
                                <complementary_color>rgb(27,94,32)</complementary_color>
                            </style>
                        </value>
                        <value id="2">
                            <code>2</code>
                            <rank>20</rank>
                            <style>
                                <main_color>rgb(240,244,195)</main_color>
                                <complementary_color>rgb(62,74,0)</complementary_color>
                            </style>
                        </value>
                        <value id="3">
                            <code>3</code>
                            <rank>30</rank>
                            <style>
                                <main_color>rgb(255,213,79)</main_color>
                                <complementary_color>rgb(78,53,16)</complementary_color>
                            </style>
                        </value>
                        <value id="4">
                            <code>4</code>
                            <rank>40</rank>
                            <style>
                                <main_color>rgb(251,140,0)</main_color>
                                <complementary_color>rgb(0,0,0)</complementary_color>
                                <decoration_classes>fas fa-exclamation-triangle</decoration_classes>
                            </style>
                        </value>
                        <value id="5">
                            <code>5</code>
                            <rank>50</rank>
                            <style>
                                <main_color>rgb(198,40,40)</main_color>
                                <complementary_color>rgb(255,255,255)</complementary_color>
                                <decoration_classes>fas fa-exclamation-triangle</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <default_value>3</default_value>
                    <is_null_allowed>false</is_null_allowed>
                    <display_style>list</display_style>
                </field>
                <field id="pre_impact" xsi:type="AttributeEnum">
                    <sql>pre_impact</sql>
                    <values>
                        <value id="1">
                            <code>1</code>
                            <rank>10</rank>
                            <style>
                                <main_color>rgb(232,245,233)</main_color>
                                <complementary_color>rgb(27,94,32)</complementary_color>
                            </style>
                        </value>
                        <value id="2">
                            <code>2</code>
                            <rank>20</rank>
                            <style>
                                <main_color>rgb(240,244,195)</main_color>
                                <complementary_color>rgb(62,74,0)</complementary_color>
                            </style>
                        </value>
                        <value id="3">
                            <code>3</code>
                            <rank>30</rank>
                            <style>
                                <main_color>rgb(255,213,79)</main_color>
                                <complementary_color>rgb(78,53,16)</complementary_color>
                            </style>
                        </value>
                        <value id="4">
                            <code>4</code>
                            <rank>40</rank>
                            <style>
                                <main_color>rgb(251,140,0)</main_color>
                                <complementary_color>rgb(0,0,0)</complementary_color>
                                <decoration_classes>fas fa-exclamation-triangle</decoration_classes>
                            </style>
                        </value>
                        <value id="5">
                            <code>5</code>
                            <rank>50</rank>
                            <style>
                                <main_color>rgb(198,40,40)</main_color>
                                <complementary_color>rgb(255,255,255)</complementary_color>
                                <decoration_classes>fas fa-exclamation-triangle</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <default_value>3</default_value>
                    <is_null_allowed>false</is_null_allowed>
                    <display_style>list</display_style>
                </field>
                <field id="pre_score" xsi:type="AttributeInteger">
                    <sql>pre_score</sql>
                    <is_null_allowed>true</is_null_allowed>
                    <dependencies>
                        <attribute id="pre_likelihood" />
                        <attribute id="pre_impact" />
                    </dependencies>
                </field>
                <field id="pre_level" xsi:type="AttributeEnum">
                    <sql>pre_level</sql>
                    <values>
                        <value id="low">
                            <code>low</code>
                            <rank>10</rank>
                            <style>
                                <main_color>rgb(232,245,233)</main_color>
                                <complementary_color>rgb(27,94,32)</complementary_color>
                                <decoration_classes>fas fa-check-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="medium">
                            <code>medium</code>
                            <rank>20</rank>
                            <style>
                                <main_color>rgb(240,244,195)</main_color>
                                <complementary_color>rgb(62,74,0)</complementary_color>
                                <decoration_classes>fas fa-minus-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="high">
                            <code>high</code>
                            <rank>30</rank>
                            <style>
                                <main_color>rgb(251,140,0)</main_color>
                                <complementary_color>rgb(0,0,0)</complementary_color>
                                <decoration_classes>fas fa-exclamation-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="extreme">
                            <code>extreme</code>
                            <rank>40</rank>
                            <style>
                                <main_color>rgb(198,40,40)</main_color>
                                <complementary_color>rgb(255,255,255)</complementary_color>
                                <decoration_classes>fas fa-exclamation-triangle</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <is_null_allowed>true</is_null_allowed>
                    <display_style>list</display_style>
                    <dependencies>
                        <attribute id="pre_likelihood" />
                        <attribute id="pre_impact" />
                    </dependencies>
                </field>
                <field id="res_likelihood" xsi:type="AttributeEnum">
                    <sql>res_likelihood</sql>
                    <values>
                        <value id="1">
                            <code>1</code>
                            <rank>10</rank>
                            <style>
                                <main_color>rgb(232,245,233)</main_color>
                                <complementary_color>rgb(27,94,32)</complementary_color>
                            </style>
                        </value>
                        <value id="2">
                            <code>2</code>
                            <rank>20</rank>
                            <style>
                                <main_color>rgb(240,244,195)</main_color>
                                <complementary_color>rgb(62,74,0)</complementary_color>
                            </style>
                        </value>
                        <value id="3">
                            <code>3</code>
                            <rank>30</rank>
                            <style>
                                <main_color>rgb(255,213,79)</main_color>
                                <complementary_color>rgb(78,53,16)</complementary_color>
                            </style>
                        </value>
                        <value id="4">
                            <code>4</code>
                            <rank>40</rank>
                            <style>
                                <main_color>rgb(251,140,0)</main_color>
                                <complementary_color>rgb(0,0,0)</complementary_color>
                                <decoration_classes>fas fa-exclamation-triangle</decoration_classes>
                            </style>
                        </value>
                        <value id="5">
                            <code>5</code>
                            <rank>50</rank>
                            <style>
                                <main_color>rgb(198,40,40)</main_color>
                                <complementary_color>rgb(255,255,255)</complementary_color>
                                <decoration_classes>fas fa-exclamation-triangle</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <is_null_allowed>true</is_null_allowed>
                    <display_style>list</display_style>
                </field>
                <field id="res_impact" xsi:type="AttributeEnum">
                    <sql>res_impact</sql>
                    <values>
                        <value id="1">
                            <code>1</code>
                            <rank>10</rank>
                            <style>
                                <main_color>rgb(232,245,233)</main_color>
                                <complementary_color>rgb(27,94,32)</complementary_color>
                            </style>
                        </value>
                        <value id="2">
                            <code>2</code>
                            <rank>20</rank>
                            <style>
                                <main_color>rgb(240,244,195)</main_color>
                                <complementary_color>rgb(62,74,0)</complementary_color>
                            </style>
                        </value>
                        <value id="3">
                            <code>3</code>
                            <rank>30</rank>
                            <style>
                                <main_color>rgb(255,213,79)</main_color>
                                <complementary_color>rgb(78,53,16)</complementary_color>
                            </style>
                        </value>
                        <value id="4">
                            <code>4</code>
                            <rank>40</rank>
                            <style>
                                <main_color>rgb(251,140,0)</main_color>
                                <complementary_color>rgb(0,0,0)</complementary_color>
                                <decoration_classes>fas fa-exclamation-triangle</decoration_classes>
                            </style>
                        </value>
                        <value id="5">
                            <code>5</code>
                            <rank>50</rank>
                            <style>
                                <main_color>rgb(198,40,40)</main_color>
                                <complementary_color>rgb(255,255,255)</complementary_color>
                                <decoration_classes>fas fa-exclamation-triangle</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <is_null_allowed>true</is_null_allowed>
                    <display_style>list</display_style>
                </field>
                <field id="res_score" xsi:type="AttributeInteger">
                    <sql>res_score</sql>
                    <is_null_allowed>true</is_null_allowed>
                    <dependencies>
                        <attribute id="res_likelihood" />
                        <attribute id="res_impact" />
                    </dependencies>
                </field>
                <field id="res_level" xsi:type="AttributeEnum">
                    <sql>res_level</sql>
                    <values>
                        <value id="low">
                            <code>low</code>
                            <rank>10</rank>
                            <style>
                                <main_color>rgb(232,245,233)</main_color>
                                <complementary_color>rgb(27,94,32)</complementary_color>
                                <decoration_classes>fas fa-check-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="medium">
                            <code>medium</code>
                            <rank>20</rank>
                            <style>
                                <main_color>rgb(240,244,195)</main_color>
                                <complementary_color>rgb(62,74,0)</complementary_color>
                                <decoration_classes>fas fa-minus-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="high">
                            <code>high</code>
                            <rank>30</rank>
                            <style>
                                <main_color>rgb(251,140,0)</main_color>
                                <complementary_color>rgb(0,0,0)</complementary_color>
                                <decoration_classes>fas fa-exclamation-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="extreme">
                            <code>extreme</code>
                            <rank>40</rank>
                            <style>
                                <main_color>rgb(198,40,40)</main_color>
                                <complementary_color>rgb(255,255,255)</complementary_color>
                                <decoration_classes>fas fa-exclamation-triangle</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <is_null_allowed>true</is_null_allowed>
                    <display_style>list</display_style>
                    <dependencies>
                        <attribute id="res_likelihood" />
                        <attribute id="res_impact" />
                    </dependencies>
                </field>
                <field id="tgt_likelihood" xsi:type="AttributeEnum">
                    <sql>tgt_likelihood</sql>
                    <values>
                        <value id="1">
                            <code>1</code>
                            <rank>10</rank>
                            <style>
                                <main_color>rgb(232,245,233)</main_color>
                                <complementary_color>rgb(27,94,32)</complementary_color>
                            </style>
                        </value>
                        <value id="2">
                            <code>2</code>
                            <rank>20</rank>
                            <style>
                                <main_color>rgb(240,244,195)</main_color>
                                <complementary_color>rgb(62,74,0)</complementary_color>
                            </style>
                        </value>
                        <value id="3">
                            <code>3</code>
                            <rank>30</rank>
                            <style>
                                <main_color>rgb(255,213,79)</main_color>
                                <complementary_color>rgb(78,53,16)</complementary_color>
                            </style>
                        </value>
                        <value id="4">
                            <code>4</code>
                            <rank>40</rank>
                            <style>
                                <main_color>rgb(251,140,0)</main_color>
                                <complementary_color>rgb(0,0,0)</complementary_color>
                                <decoration_classes>fas fa-exclamation-triangle</decoration_classes>
                            </style>
                        </value>
                        <value id="5">
                            <code>5</code>
                            <rank>50</rank>
                            <style>
                                <main_color>rgb(198,40,40)</main_color>
                                <complementary_color>rgb(255,255,255)</complementary_color>
                                <decoration_classes>fas fa-exclamation-triangle</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <is_null_allowed>true</is_null_allowed>
                    <display_style>list</display_style>
                </field>
                <field id="tgt_impact" xsi:type="AttributeEnum">
                    <sql>tgt_impact</sql>
                    <values>
                        <value id="1">
                            <code>1</code>
                            <rank>10</rank>
                            <style>
                                <main_color>rgb(232,245,233)</main_color>
                                <complementary_color>rgb(27,94,32)</complementary_color>
                            </style>
                        </value>
                        <value id="2">
                            <code>2</code>
                            <rank>20</rank>
                            <style>
                                <main_color>rgb(240,244,195)</main_color>
                                <complementary_color>rgb(62,74,0)</complementary_color>
                            </style>
                        </value>
                        <value id="3">
                            <code>3</code>
                            <rank>30</rank>
                            <style>
                                <main_color>rgb(255,213,79)</main_color>
                                <complementary_color>rgb(78,53,16)</complementary_color>
                            </style>
                        </value>
                        <value id="4">
                            <code>4</code>
                            <rank>40</rank>
                            <style>
                                <main_color>rgb(251,140,0)</main_color>
                                <complementary_color>rgb(0,0,0)</complementary_color>
                                <decoration_classes>fas fa-exclamation-triangle</decoration_classes>
                            </style>
                        </value>
                        <value id="5">
                            <code>5</code>
                            <rank>50</rank>
                            <style>
                                <main_color>rgb(198,40,40)</main_color>
                                <complementary_color>rgb(255,255,255)</complementary_color>
                                <decoration_classes>fas fa-exclamation-triangle</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <is_null_allowed>true</is_null_allowed>
                    <display_style>list</display_style>
                </field>
                <field id="tgt_score" xsi:type="AttributeInteger">
                    <sql>tgt_score</sql>
                    <is_null_allowed>true</is_null_allowed>
                    <dependencies>
                        <attribute id="tgt_likelihood" />
                        <attribute id="tgt_impact" />
                    </dependencies>
                </field>
                <field id="tgt_level" xsi:type="AttributeEnum">
                    <sql>tgt_level</sql>
                    <values>
                        <value id="low">
                            <code>low</code>
                            <rank>10</rank>
                            <style>
                                <main_color>rgb(232,245,233)</main_color>
                                <complementary_color>rgb(27,94,32)</complementary_color>
                                <decoration_classes>far fa-flag</decoration_classes>
                            </style>
                        </value>
                        <value id="medium">
                            <code>medium</code>
                            <rank>20</rank>
                            <style>
                                <main_color>rgb(240,244,195)</main_color>
                                <complementary_color>rgb(62,74,0)</complementary_color>
                                <decoration_classes>far fa-flag</decoration_classes>
                            </style>
                        </value>
                        <value id="high">
                            <code>high</code>
                            <rank>30</rank>
                            <style>
                                <main_color>rgb(251,140,0)</main_color>
                                <complementary_color>rgb(0,0,0)</complementary_color>
                                <decoration_classes>far fa-flag</decoration_classes>
                            </style>
                        </value>
                        <value id="extreme">
                            <code>extreme</code>
                            <rank>40</rank>
                            <style>
                                <main_color>rgb(198,40,40)</main_color>
                                <complementary_color>rgb(255,255,255)</complementary_color>
                                <decoration_classes>far fa-flag</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <is_null_allowed>true</is_null_allowed>
                    <display_style>list</display_style>
                    <dependencies>
                        <attribute id="tgt_likelihood" />
                        <attribute id="tgt_impact" />
                    </dependencies>
                </field>
                <field id="aggregation_mode" xsi:type="AttributeEnum">
                    <sql>aggregation_mode</sql>
                    <values>
                        <value id="inherit">
                            <code>inherit</code>
                            <rank>10</rank>
                        </value>
                        <value id="max">
                            <code>max</code>
                            <rank>20</rank>
                        </value>
                        <value id="sum_capped">
                            <code>sum_capped</code>
                            <rank>30</rank>
                        </value>
                    </values>
                    <default_value>inherit</default_value>
                    <is_null_allowed>false</is_null_allowed>
                    <display_style>list</display_style>
                </field>
                <field id="treatment_decision" xsi:type="AttributeEnum">
                    <sql>treatment_decision</sql>
                    <values>
                        <value id="mitigate">
                            <code>mitigate</code>
                            <rank>10</rank>
                        </value>
                        <value id="accept">
                            <code>accept</code>
                            <rank>20</rank>
                        </value>
                        <value id="avoid">
                            <code>avoid</code>
                            <rank>30</rank>
                        </value>
                        <value id="transfer">
                            <code>transfer</code>
                            <rank>40</rank>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <default_value>mitigate</default_value>
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="treatment_owner_id" xsi:type="AttributeExternalKey">
                    <sql>treatment_owner_id</sql>
                    <target_class>Person</target_class>
                    <filter><![CDATA[SELECT Person WHERE org_id = :this->org_id]]></filter>
                    <dependencies>
                        <attribute id="org_id" />
                    </dependencies>
                    <is_null_allowed>true</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="treatment_owner_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>treatment_owner_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="treatment_due" xsi:type="AttributeDate">
                    <sql>treatment_due</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="treatment_plan" xsi:type="AttributeText">
                    <sql>treatment_plan</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="acceptance_status" xsi:type="AttributeEnum">
                    <sql>acceptance_status</sql>
                    <values>
                        <value id="pending">
                            <code>pending</code>
                            <rank>10</rank>
                        </value>
                        <value id="accepted">
                            <code>accepted</code>
                            <rank>20</rank>
                        </value>
                        <value id="rejected">
                            <code>rejected</code>
                            <rank>30</rank>
                        </value>
                    </values>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="accepted_by_id" xsi:type="AttributeExternalKey">
                    <sql>accepted_by_id</sql>
                    <target_class>Person</target_class>
                    <filter><![CDATA[SELECT Person WHERE org_id = :this->org_id]]></filter>
                    <dependencies>
                        <attribute id="org_id" />
                    </dependencies>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="accepted_by_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>accepted_by_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="acceptance_date" xsi:type="AttributeDate">
                    <sql>acceptance_date</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="acceptance_rationale" xsi:type="AttributeText">
                    <sql>acceptance_rationale</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="controls_list" xsi:type="AttributeLinkedSetIndirect">
                    <linked_class>lnkISMSRiskToISMSControl</linked_class>
                    <ext_key_to_me>risk_id</ext_key_to_me>
                    <ext_key_to_remote>control_id</ext_key_to_remote>
                    <count_min>0</count_min>
                    <count_max>0</count_max>
                    <duplicates>false</duplicates>
                    <with_php_constraint>true</with_php_constraint>
                    <with_php_computation>true</with_php_computation>
                </field>
                <field id="reviews_list" xsi:type="AttributeLinkedSet">
                    <linked_class>ISMSRiskReview</linked_class>
                    <ext_key_to_me>risk_id</ext_key_to_me>
                    <edit_mode>add_only</edit_mode>
                    <count_min>0</count_min>
                    <count_max>0</count_max>
                </field>
            </fields>
            <lifecycle>
                <stimuli>
                    <stimulus id="ev_publish" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_draft" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_obsolete" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_reopen" xsi:type="StimulusUserAction" />
                </stimuli>
                <states>
                    <state id="draft">
                        <flags>
                            <attribute id="ref">
                                <read_only />
                            </attribute>
                            <attribute id="creation_date">
                                <read_only />
                            </attribute>
                            <attribute id="publish_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_update">
                                <read_only />
                            </attribute>
                            <attribute id="pre_score">
                                <read_only />
                            </attribute>
                            <attribute id="pre_level">
                                <read_only />
                            </attribute>
                            <attribute id="res_score">
                                <read_only />
                            </attribute>
                            <attribute id="res_level">
                                <read_only />
                            </attribute>
                            <attribute id="tgt_score">
                                <read_only />
                            </attribute>
                            <attribute id="tgt_level">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_publish">
                                <target>published</target>
                                <actions>
                                    <action id="1">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">publish_date</param>
                                        </params>
                                    </action>
                                    <!-- done by event EVENT_DB_BEFORE_WRITE: EvtBeforeISMSRiskWrite
                                    <action id="9">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">last_update</param>
                                        </params>
                                    </action>
                                -->
                                </actions>
                            </transition>
                        </transitions>
                    </state>
                    <state id="published">
                        <flags>
                            <attribute id="ref">
                                <read_only />
                            </attribute>
                            <!-- Core identity & dates locked -->
                            <attribute id="name">
                                <read_only />
                            </attribute>
                            <attribute id="org_id">
                                <read_only />
                            </attribute>
                            <attribute id="riskowner_id">
                                <read_only />
                            </attribute>
                            <!-- Risk context locked once published -->
                            <attribute id="risk_category">
                                <read_only />
                            </attribute>
                            <attribute id="risk_cause">
                                <read_only />
                            </attribute>
                            <attribute id="risk_event">
                                <read_only />
                            </attribute>
                            <attribute id="risk_consequence">
                                <read_only />
                            </attribute>
                            <attribute id="description">
                                <read_only />
                            </attribute>
                            <attribute id="creation_date">
                                <read_only />
                            </attribute>
                            <attribute id="publish_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_update">
                                <read_only />
                            </attribute>
                            <!-- Inherent input fixed (baseline) -->
                            <attribute id="pre_likelihood">
                                <mandatory />
                                <read_only />
                            </attribute>
                            <attribute id="pre_impact">
                                <mandatory />
                                <read_only />
                            </attribute>
                            <!-- Computed fields are already forced read-only by events -->
                            <attribute id="pre_score">
                                <read_only />
                            </attribute>
                            <attribute id="pre_level">
                                <read_only />
                            </attribute>
                            <attribute id="res_score">
                                <read_only />
                            </attribute>
                            <attribute id="res_level">
                                <read_only />
                            </attribute>
                            <attribute id="tgt_score">
                                <read_only />
                            </attribute>
                            <attribute id="tgt_level">
                                <read_only />
                            </attribute>
                            <!-- Unlock aggregation mode -->
                            <attribute id="aggregation_mode" />
                        </flags>
                        <transitions>
                            <transition id="ev_draft">
                                <target>draft</target>
                                <actions>
                                    <action id="1">
                                        <verb>Reset</verb>
                                        <params>
                                            <param xsi:type="attcode">publish_date</param>
                                        </params>
                                    </action>
                                    <!-- done by event EVENT_DB_BEFORE_WRITE: EvtBeforeISMSRiskWrite
                                    <action id="9">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">last_update</param>
                                        </params>
                                    </action>
                                -->
                                </actions>
                            </transition>
                            <transition id="ev_obsolete">
                                <target>obsolete</target>
                                <actions>
                                    <!-- done by event EVENT_DB_BEFORE_WRITE: EvtBeforeISMSRiskWrite
                                    <action id="9">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">last_update</param>
                                        </params>
                                    </action>
                                -->
                                </actions>
                            </transition>
                        </transitions>
                    </state>
                    <state id="obsolete">
                        <flags>
                            <attribute id="ref">
                                <read_only />
                            </attribute>
                            <attribute id="name">
                                <read_only />
                            </attribute>
                            <attribute id="org_id">
                                <read_only />
                            </attribute>
                            <attribute id="status">
                                <read_only />
                            </attribute>
                            <attribute id="riskowner_id">
                                <read_only />
                            </attribute>
                            <attribute id="risk_category">
                                <read_only />
                            </attribute>
                            <attribute id="risk_cause">
                                <read_only />
                            </attribute>
                            <attribute id="risk_event">
                                <read_only />
                            </attribute>
                            <attribute id="risk_consequence">
                                <read_only />
                            </attribute>
                            <attribute id="description">
                                <read_only />
                            </attribute>
                            <attribute id="pre_likelihood">
                                <read_only />
                            </attribute>
                            <attribute id="pre_impact">
                                <read_only />
                            </attribute>
                            <attribute id="pre_score">
                                <read_only />
                            </attribute>
                            <attribute id="pre_level">
                                <read_only />
                            </attribute>
                            <attribute id="res_likelihood">
                                <read_only />
                            </attribute>
                            <attribute id="res_impact">
                                <read_only />
                            </attribute>
                            <attribute id="res_score">
                                <read_only />
                            </attribute>
                            <attribute id="res_level">
                                <read_only />
                            </attribute>
                            <attribute id="tgt_likelihood">
                                <read_only />
                            </attribute>
                            <attribute id="tgt_impact">
                                <read_only />
                            </attribute>
                            <attribute id="tgt_score">
                                <read_only />
                            </attribute>
                            <attribute id="tgt_level">
                                <read_only />
                            </attribute>
                            <attribute id="aggregation_mode">
                                <read_only />
                            </attribute>
                            <attribute id="treatment_decision">
                                <read_only />
                            </attribute>
                            <attribute id="treatment_owner_id">
                                <read_only />
                            </attribute>
                            <attribute id="treatment_due">
                                <read_only />
                            </attribute>
                            <attribute id="treatment_plan">
                                <read_only />
                            </attribute>
                            <attribute id="acceptance_status">
                                <read_only />
                            </attribute>
                            <attribute id="accepted_by_id">
                                <read_only />
                            </attribute>
                            <attribute id="acceptance_date">
                                <read_only />
                            </attribute>
                            <attribute id="acceptance_rationale">
                                <read_only />
                            </attribute>
                            <attribute id="creation_date">
                                <read_only />
                            </attribute>
                            <attribute id="publish_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_update">
                                <read_only />
                            </attribute>
                            <attribute id="next_review">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_reopen">
                                <target>draft</target>
                                <actions>
                                    <action id="1">
                                        <verb>Reset</verb>
                                        <params>
                                            <param xsi:type="attcode">publish_date</param>
                                        </params>
                                    </action>
                                    <!-- done by event EVENT_DB_BEFORE_WRITE: EvtBeforeISMSRiskWrite
                                    <action id="9">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">last_update</param>
                                        </params>
                                    </action>
                                -->
                                </actions>
                            </transition>
                        </transitions>
                    </state>
                </states>
            </lifecycle>
            <relations>
                <relation id="impacts">
                    <neighbours>
                        <neighbour id="ismscontrol">
                            <query_up><![CDATA[ SELECT ISMSControl AS up JOIN lnkISMSRiskToISMSControl AS lnk ON lnk.control_id = up.id WHERE lnk.risk_id = :this->id]]></query_up>
                            <query_down><![CDATA[SELECT ISMSControl AS down WHERE 1 = 0]]></query_down>
                        </neighbour>
                        <neighbour id="ismsasset">
                            <direction>down</direction>
                            <query_down><![CDATA[SELECT ISMSAsset AS down JOIN lnkISMSRiskToISMSAsset AS lnk ON lnk.asset_id = down.id WHERE lnk.risk_id = :this->id]]></query_down>
                        </neighbour>
                    </neighbours>
                </relation>
            </relations>
            <event_listeners>
                <event_listener id="EvtSetInitialISMSRiskAttributeFlags">
                    <event>EVENT_DB_SET_INITIAL_ATTRIBUTES_FLAGS</event>
                    <rank>10</rank>
                    <callback>EvtSetInitialISMSRiskAttributeFlags</callback>
                </event_listener>
                <event_listener id="EvtSetISMSRiskAttributeFlags">
                    <event>EVENT_DB_SET_ATTRIBUTES_FLAGS</event>
                    <rank>10</rank>
                    <callback>EvtSetISMSRiskAttributeFlags</callback>
                </event_listener>
                <event_listener id="EvtCheckISMSRiskToWrite">
                    <event>EVENT_DB_CHECK_TO_WRITE</event>
                    <rank>10</rank>
                    <callback>EvtCheckISMSRiskToWrite</callback>
                </event_listener>
                <event_listener id="EvtBeforeISMSRiskWrite">
                    <event>EVENT_DB_BEFORE_WRITE</event>
                    <rank>10</rank>
                    <callback>EvtBeforeISMSRiskWrite</callback>
                </event_listener>
                <event_listener id="EvtComputeISMSRiskValues">
                    <event>EVENT_DB_COMPUTE_VALUES</event>
                    <rank>10</rank>
                    <callback>EvtComputeISMSRiskValues</callback>
                </event_listener>
                <event_listener id="EvtISMSRiskLinksChanged">
                    <event>EVENT_DB_LINKS_CHANGED</event>
                    <rank>10</rank>
                    <callback>EvtISMSRiskLinksChanged</callback>
                </event_listener>
            </event_listeners>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="col:col0">
                            <rank>10</rank>
                            <items>
                                <item id="fieldset:ISMSRisk:Base">
                                    <rank>10</rank>
                                    <items>
                                        <item id="name">
                                            <rank>10</rank>
                                        </item>
                                        <item id="org_id">
                                            <rank>20</rank>
                                        </item>
                                        <item id="status">
                                            <rank>30</rank>
                                        </item>
                                        <item id="riskowner_id">
                                            <rank>40</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSRisk:Context">
                                    <rank>20</rank>
                                    <items>
                                        <item id="risk_category">
                                            <rank>10</rank>
                                        </item>
                                        <item id="risk_cause">
                                            <rank>20</rank>
                                        </item>
                                        <item id="risk_event">
                                            <rank>30</rank>
                                        </item>
                                        <item id="risk_consequence">
                                            <rank>40</rank>
                                        </item>
                                        <item id="description">
                                            <rank>50</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="col:col1">
                            <rank>20</rank>
                            <items>
                                <item id="fieldset:ISMSRisk:Summary">
                                    <rank>10</rank>
                                    <items>
                                        <!--
                                        <item id="pre_level">
                                            <rank>10</rank>
                                        </item>
                                        <item id="pre_score">
                                            <rank>20</rank>
                                        </item>
                                        <item id="res_level">
                                            <rank>30</rank>
                                        </item>
                                        <item id="res_score">
                                            <rank>40</rank>
                                        </item>
                                        -->
                                        <item id="aggregation_mode">
                                            <rank>50</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSRisk:Preliminary">
                                    <rank>20</rank>
                                    <items>
                                        <item id="pre_likelihood">
                                            <rank>10</rank>
                                        </item>
                                        <item id="pre_impact">
                                            <rank>20</rank>
                                        </item>
                                        <item id="pre_score">
                                            <rank>30</rank>
                                        </item>
                                        <item id="pre_level">
                                            <rank>40</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSRisk:Residual">
                                    <rank>30</rank>
                                    <items>
                                        <item id="res_likelihood">
                                            <rank>10</rank>
                                        </item>
                                        <item id="res_impact">
                                            <rank>20</rank>
                                        </item>
                                        <item id="res_score">
                                            <rank>30</rank>
                                        </item>
                                        <item id="res_level">
                                            <rank>40</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSRisk:TargetResidual">
                                    <rank>40</rank>
                                    <items>
                                        <item id="tgt_likelihood">
                                            <rank>10</rank>
                                        </item>
                                        <item id="tgt_impact">
                                            <rank>20</rank>
                                        </item>
                                        <item id="tgt_score">
                                            <rank>30</rank>
                                        </item>
                                        <item id="tgt_level">
                                            <rank>40</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="col:col2">
                            <rank>30</rank>
                            <items>
                                <item id="fieldset:ISMSRisk:Dates">
                                    <rank>10</rank>
                                    <items>
                                        <item id="creation_date">
                                            <rank>10</rank>
                                        </item>
                                        <item id="last_update">
                                            <rank>20</rank>
                                        </item>
                                        <item id="publish_date">
                                            <rank>30</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSRisk:Treatment">
                                    <rank>20</rank>
                                    <items>
                                        <item id="treatment_decision">
                                            <rank>10</rank>
                                        </item>
                                        <item id="treatment_owner_id">
                                            <rank>20</rank>
                                        </item>
                                        <item id="treatment_due">
                                            <rank>30</rank>
                                        </item>
                                        <item id="treatment_plan">
                                            <rank>40</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSRisk:Acceptance">
                                    <rank>30</rank>
                                    <items>
                                        <item id="acceptance_status">
                                            <rank>10</rank>
                                        </item>
                                        <item id="accepted_by_id">
                                            <rank>20</rank>
                                        </item>
                                        <item id="acceptance_date">
                                            <rank>30</rank>
                                        </item>
                                        <item id="acceptance_rationale">
                                            <rank>40</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSReview:Reviews">
                                    <rank>40</rank>
                                    <items>
                                        <item id="review_interval_months">
                                            <rank>10</rank>
                                        </item>
                                        <item id="last_review">
                                            <rank>20</rank>
                                        </item>
                                        <item id="next_review">
                                            <rank>30</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="assets_list">
                            <rank>100</rank>
                        </item>
                        <item id="controls_list">
                            <rank>110</rank>
                        </item>
                        <item id="reviews_list">
                            <rank>120</rank>
                        </item>
                    </items>
                </details>
                <default_search>
                    <items>
                        <item id="ref">
                            <rank>10</rank>
                        </item>
                        <item id="name">
                            <rank>20</rank>
                        </item>
                        <item id="riskowner_id">
                            <rank>30</rank>
                        </item>
                        <item id="status">
                            <rank>40</rank>
                        </item>
                        <item id="risk_category">
                            <rank>50</rank>
                        </item>
                        <item id="org_id">
                            <rank>60</rank>
                        </item>
                    </items>
                </default_search>
                <search>
                    <items>
                        <item id="org_id">
                            <rank>10</rank>
                        </item>
                        <item id="status">
                            <rank>20</rank>
                        </item>
                        <item id="risk_category">
                            <rank>30</rank>
                        </item>
                        <item id="riskowner_id">
                            <rank>40</rank>
                        </item>
                        <item id="pre_level">
                            <rank>50</rank>
                        </item>
                        <item id="res_level">
                            <rank>60</rank>
                        </item>
                        <item id="res_score">
                            <rank>70</rank>
                        </item>
                        <item id="description">
                            <rank>80</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="org_id">
                            <rank>20</rank>
                        </item>
                        <item id="status">
                            <rank>30</rank>
                        </item>
                        <item id="riskowner_id">
                            <rank>40</rank>
                        </item>
                        <item id="risk_category">
                            <rank>50</rank>
                        </item>
                        <item id="treatment_decision">
                            <rank>60</rank>
                        </item>
                        <item id="res_score">
                            <rank>70</rank>
                        </item>
                    </items>
                </list>
            </presentation>
        </class>
        <class id="lnkISMSRiskToISMSAsset" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <properties>
                <is_link>1</is_link>
                <category>bizmodel</category>
                <abstract>false</abstract>
                <key_type>autoincrement</key_type>
                <db_table>lnkismsrisktoismsasset</db_table>
                <db_key_field>id</db_key_field>
                <db_final_class_field />
                <naming>
                    <attributes>
                        <attribute id="risk_id" />
                        <attribute id="asset_id" />
                    </attributes>
                </naming>
                <indexes>
                    <index id="risk_id">
                        <attributes>
                            <attribute id="risk_id" />
                        </attributes>
                    </index>
                    <index id="asset_id">
                        <attributes>
                            <attribute id="asset_id" />
                        </attributes>
                    </index>
                    <index id="risk_asset">
                        <attributes>
                            <attribute id="risk_id" />
                            <attribute id="asset_id" />
                        </attributes>
                    </index>
                </indexes>
                <reconciliation>
                    <attributes>
                        <attribute id="risk_id" />
                        <attribute id="asset_id" />
                    </attributes>
                </reconciliation>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="risk_id" />
                            <attribute id="asset_id" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
            </properties>
            <fields>
                <field id="risk_id" xsi:type="AttributeExternalKey">
                    <sql>risk_id</sql>
                    <target_class>ISMSRisk</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="risk_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>risk_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="asset_id" xsi:type="AttributeExternalKey">
                    <sql>asset_id</sql>
                    <target_class>ISMSAsset</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="asset_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>asset_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
            </fields>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="risk_id">
                            <rank>10</rank>
                        </item>
                        <item id="asset_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </details>
                <search>
                    <items>
                        <item id="risk_id">
                            <rank>10</rank>
                        </item>
                        <item id="asset_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="risk_id">
                            <rank>20</rank>
                        </item>
                        <item id="asset_id">
                            <rank>30</rank>
                        </item>
                    </items>
                </list>
            </presentation>
        </class>
        <class id="ISMSControl" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <php_parent>
                <name>BR_isms\Extension\Framework\Model\_ISMSControl</name>
                <file>src/_ISMSControl.php</file>
            </php_parent>
            <properties>
                <category>bizmodel,searchable</category>
                <abstract>false</abstract>
                <db_table>ismscontrol</db_table>
                <db_key_field>id</db_key_field>
                <key_type>autoincrement</key_type>
                <db_final_class_field />
                <naming>
                    <attributes>
                        <attribute id="ref" />
                        <attribute id="name" />
                    </attributes>
                </naming>
                <fields_semantic>
                    <state_attribute>status</state_attribute>
                </fields_semantic>
                <style>
                    <icon>images/isms-control.svg</icon>
                </style>
                <reconciliation>
                    <attributes>
                        <attribute id="ref" />
                        <attribute id="name" />
                        <attribute id="org_id" />
                        <attribute id="organization_name" />
                    </attributes>
                </reconciliation>
                <indexes>
                    <index id="ref">
                        <attributes>
                            <attribute id="ref" />
                        </attributes>
                    </index>
                </indexes>
                <uniqueness_rules>
                    <rule id="ref">
                        <attributes>
                            <attribute id="ref" />
                        </attributes>
                        <is_blocking>false</is_blocking>
                    </rule>
                    <rule id="name">
                        <attributes>
                            <attribute id="org_id" />
                            <attribute id="name" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
                <obsolescence>
                    <condition><![CDATA[status='retired']]></condition>
                </obsolescence>
            </properties>
            <fields>
                <field id="ref" xsi:type="AttributeString">
                    <sql>ref</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="name" xsi:type="AttributeString">
                    <sql>name</sql>
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="org_id" xsi:type="AttributeExternalKey">
                    <sql>org_id</sql>
                    <target_class>Organization</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                </field>
                <field id="organization_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>org_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="status" xsi:type="AttributeEnum">
                    <sql>status</sql>
                    <values>
                        <value id="draft">
                            <code>draft</code>
                            <rank>10</rank>
                            <style>
                                <main_color>$ibo-lifecycle-new-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-new-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-plus-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="submitted">
                            <code>submitted</code>
                            <rank>20</rank>
                            <style>
                                <main_color>$ibo-lifecycle-waiting-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-waiting-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-plus-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="approved">
                            <code>approved</code>
                            <rank>30</rank>
                            <style>
                                <main_color>$ibo-lifecycle-success-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-success-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-check-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="implementing">
                            <code>implementing</code>
                            <rank>40</rank>
                            <style>
                                <main_color>$ibo-lifecycle-neutral-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-neutral-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-plus-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="amending">
                            <code>amending</code>
                            <rank>50</rank>
                            <style>
                                <main_color>$ibo-lifecycle-waiting-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-waiting-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-minus-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="effective">
                            <code>effective</code>
                            <rank>60</rank>
                            <style>
                                <main_color>$ibo-lifecycle-active-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-active-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-check-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="suspended">
                            <code>suspended</code>
                            <rank>70</rank>
                            <style>
                                <main_color>$ibo-lifecycle-frozen-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-frozen-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-minus-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="retired">
                            <code>retired</code>
                            <rank>80</rank>
                            <style>
                                <main_color>$ibo-lifecycle-inactive-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-inactive-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-times-circle</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <default_value>draft</default_value>
                    <is_null_allowed>false</is_null_allowed>
                    <sort_type>rank</sort_type>
                    <display_style>list</display_style>
                </field>
                <field id="controlowner_id" xsi:type="AttributeExternalKey">
                    <sql>controlowner_id</sql>
                    <target_class>Person</target_class>
                    <filter><![CDATA[SELECT Person WHERE org_id = :this->org_id]]></filter>
                    <dependencies>
                        <attribute id="org_id" />
                    </dependencies>
                    <is_null_allowed>true</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="controlowner_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>controlowner_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="control_domain" xsi:type="AttributeEnum">
                    <sql>control_domain</sql>
                    <values>
                        <value id="organizational">
                            <code>organizational</code>
                            <rank>10</rank>
                        </value>
                        <value id="people">
                            <code>people</code>
                            <rank>20</rank>
                        </value>
                        <value id="physical">
                            <code>physical</code>
                            <rank>30</rank>
                        </value>
                        <value id="technological">
                            <code>technological</code>
                            <rank>40</rank>
                        </value>
                    </values>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="control_type" xsi:type="AttributeEnum">
                    <sql>control_type</sql>
                    <values>
                        <value id="preventive">
                            <code>preventive</code>
                            <rank>10</rank>
                        </value>
                        <value id="detective">
                            <code>detective</code>
                            <rank>20</rank>
                        </value>
                        <value id="corrective">
                            <code>corrective</code>
                            <rank>30</rank>
                        </value>
                    </values>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="description" xsi:type="AttributeText">
                    <sql>description</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="creation_date" xsi:type="AttributeDate">
                    <sql>creation_date</sql>
                    <default_value />
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="last_update" xsi:type="AttributeDateTime">
                    <sql>last_update</sql>
                    <default_value />
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="approval_date" xsi:type="AttributeDate">
                    <sql>approval_date</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="implementation_date" xsi:type="AttributeDate">
                    <sql>implementation_date</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <!-- Review interval in months (3/6/12/24), Default 12 -->
                <field id="review_interval_months" xsi:type="AttributeEnum" _delta="define">
                    <sql>review_interval_months</sql>
                    <values>
                        <value id="3">
                            <code>3</code>
                        </value>
                        <value id="6">
                            <code>6</code>
                        </value>
                        <value id="12">
                            <code>12</code>
                        </value>
                        <value id="24">
                            <code>24</code>
                        </value>
                    </values>
                    <is_null_allowed>false</is_null_allowed>
                    <display_style>list</display_style>
                    <sort_type>code</sort_type>
                </field>
                <field id="last_review" xsi:type="AttributeDate">
                    <sql>last_review</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="next_review" xsi:type="AttributeDate">
                    <sql>next_review</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="risks_list" xsi:type="AttributeLinkedSetIndirect">
                    <linked_class>lnkISMSRiskToISMSControl</linked_class>
                    <ext_key_to_me>control_id</ext_key_to_me>
                    <ext_key_to_remote>risk_id</ext_key_to_remote>
                    <count_min>0</count_min>
                    <count_max>0</count_max>
                    <duplicates>false</duplicates>
                </field>
                <field id="reviews_list" xsi:type="AttributeLinkedSet">
                    <linked_class>ISMSControlReview</linked_class>
                    <ext_key_to_me>control_id</ext_key_to_me>
                    <edit_mode>add_only</edit_mode>
                    <count_min>0</count_min>
                    <count_max>0</count_max>
                </field>
                <field id="soaentries_list" xsi:type="AttributeLinkedSetIndirect">
                    <linked_class>lnkISMSSoAEntryToISMSControl</linked_class>
                    <ext_key_to_me>control_id</ext_key_to_me>
                    <ext_key_to_remote>soaentry_id</ext_key_to_remote>
                </field>
            </fields>
            <relations>
                <relation id="impacts">
                    <neighbours>
                        <neighbour id="ismsrisk">
                            <direction>down</direction>
                            <query_down><![CDATA[SELECT ISMSRisk AS down JOIN lnkISMSRiskToISMSControl AS lnk ON lnk.risk_id = down.id WHERE lnk.control_id = :this->id]]></query_down>
                        </neighbour>
                    </neighbours>
                </relation>
            </relations>
            <lifecycle>
                <stimuli>
                    <stimulus id="ev_submit" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_approve" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_reject" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_start_impl" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_mark_effective" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_suspend" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_resume" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_retire" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_start_amend" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_submit_amend" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_cancel_amend" xsi:type="StimulusUserAction" />
                </stimuli>
                <states>
                    <state id="draft">
                        <flags>
                            <attribute id="ref">
                                <read_only />
                            </attribute>
                            <attribute id="creation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_update">
                                <read_only />
                            </attribute>
                            <attribute id="approval_date">
                                <read_only />
                            </attribute>
                            <attribute id="implementation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_review">
                                <read_only />
                            </attribute>
                            <attribute id="next_review">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_submit">
                                <target>submitted</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="submitted">
                        <flags>
                            <attribute id="ref">
                                <read_only />
                            </attribute>
                            <attribute id="name">
                                <read_only />
                            </attribute>
                            <attribute id="org_id">
                                <read_only />
                            </attribute>
                            <attribute id="controlowner_id">
                                <read_only />
                            </attribute>
                            <attribute id="control_domain">
                                <read_only />
                            </attribute>
                            <attribute id="control_type">
                                <read_only />
                            </attribute>
                            <attribute id="creation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_update">
                                <read_only />
                            </attribute>
                            <attribute id="approval_date">
                                <read_only />
                            </attribute>
                            <attribute id="implementation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_review">
                                <read_only />
                            </attribute>
                            <attribute id="next_review">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_approve">
                                <target>approved</target>
                                <actions>
                                    <action id="1">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">approval_date</param>
                                        </params>
                                    </action>
                                </actions>
                            </transition>
                            <transition id="ev_reject">
                                <target>amending</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="approved">
                        <flags>
                            <attribute id="ref">
                                <read_only />
                            </attribute>
                            <attribute id="name">
                                <read_only />
                            </attribute>
                            <attribute id="org_id">
                                <read_only />
                            </attribute>
                            <attribute id="controlowner_id">
                                <read_only />
                            </attribute>
                            <attribute id="control_domain">
                                <read_only />
                            </attribute>
                            <attribute id="control_type">
                                <read_only />
                            </attribute>
                            <attribute id="creation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_update">
                                <read_only />
                            </attribute>
                            <attribute id="approval_date">
                                <read_only />
                            </attribute>
                            <attribute id="implementation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_review">
                                <read_only />
                            </attribute>
                            <attribute id="next_review">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_start_impl">
                                <target>implementing</target>
                                <actions />
                            </transition>
                            <transition id="ev_mark_effective">
                                <target>effective</target>
                                <actions>
                                    <action id="1">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">implementation_date</param>
                                        </params>
                                    </action>
                                </actions>
                            </transition>
                            <transition id="ev_retire">
                                <target>retired</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="implementing">
                        <flags>
                            <attribute id="ref">
                                <read_only />
                            </attribute>
                            <attribute id="name">
                                <read_only />
                            </attribute>
                            <attribute id="org_id">
                                <read_only />
                            </attribute>
                            <attribute id="controlowner_id">
                                <read_only />
                            </attribute>
                            <attribute id="control_domain">
                                <read_only />
                            </attribute>
                            <attribute id="control_type">
                                <read_only />
                            </attribute>
                            <attribute id="creation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_update">
                                <read_only />
                            </attribute>
                            <attribute id="approval_date">
                                <read_only />
                            </attribute>
                            <attribute id="implementation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_review">
                                <read_only />
                            </attribute>
                            <attribute id="next_review">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_mark_effective">
                                <target>effective</target>
                                <actions>
                                    <action id="1">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">implementation_date</param>
                                        </params>
                                    </action>
                                </actions>
                            </transition>
                            <transition id="ev_retire">
                                <target>retired</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="amending">
                        <flags>
                            <attribute id="ref">
                                <read_only />
                            </attribute>
                            <attribute id="org_id">
                                <read_only />
                            </attribute>
                            <attribute id="creation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_update">
                                <read_only />
                            </attribute>
                            <attribute id="approval_date">
                                <read_only />
                            </attribute>
                            <attribute id="implementation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_review">
                                <read_only />
                            </attribute>
                            <attribute id="next_review">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_submit_amend">
                                <target>submitted</target>
                                <actions />
                            </transition>
                            <transition id="ev_cancel_amend">
                                <target>effective</target>
                                <actions />
                            </transition>
                            <transition id="ev_retire">
                                <target>retired</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="effective">
                        <flags>
                            <attribute id="ref">
                                <read_only />
                            </attribute>
                            <attribute id="name">
                                <read_only />
                            </attribute>
                            <attribute id="org_id">
                                <read_only />
                            </attribute>
                            <attribute id="control_domain">
                                <read_only />
                            </attribute>
                            <attribute id="control_type">
                                <read_only />
                            </attribute>
                            <attribute id="creation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_update">
                                <read_only />
                            </attribute>
                            <attribute id="approval_date">
                                <read_only />
                            </attribute>
                            <attribute id="implementation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_review">
                                <read_only />
                            </attribute>
                            <attribute id="next_review">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_start_amend">
                                <target>amending</target>
                                <actions />
                            </transition>
                            <transition id="ev_suspend">
                                <target>suspended</target>
                                <actions />
                            </transition>
                            <transition id="ev_retire">
                                <target>retired</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="suspended">
                        <flags>
                            <attribute id="ref">
                                <read_only />
                            </attribute>
                            <attribute id="name">
                                <read_only />
                            </attribute>
                            <attribute id="org_id">
                                <read_only />
                            </attribute>
                            <attribute id="controlowner_id">
                                <read_only />
                            </attribute>
                            <attribute id="control_domain">
                                <read_only />
                            </attribute>
                            <attribute id="control_type">
                                <read_only />
                            </attribute>
                            <attribute id="creation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_update">
                                <read_only />
                            </attribute>
                            <attribute id="approval_date">
                                <read_only />
                            </attribute>
                            <attribute id="implementation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_review">
                                <read_only />
                            </attribute>
                            <attribute id="next_review">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_resume">
                                <target>effective</target>
                                <actions />
                            </transition>
                            <transition id="ev_retire">
                                <target>retired</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="retired">
                        <flags>
                            <attribute id="ref">
                                <read_only />
                            </attribute>
                            <attribute id="name">
                                <read_only />
                            </attribute>
                            <attribute id="org_id">
                                <read_only />
                            </attribute>
                            <attribute id="status">
                                <read_only />
                            </attribute>
                            <attribute id="controlowner_id">
                                <read_only />
                            </attribute>
                            <attribute id="control_domain">
                                <read_only />
                            </attribute>
                            <attribute id="control_type">
                                <read_only />
                            </attribute>
                            <attribute id="description">
                                <read_only />
                            </attribute>
                            <attribute id="creation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_update">
                                <read_only />
                            </attribute>
                            <attribute id="approval_date">
                                <read_only />
                            </attribute>
                            <attribute id="implementation_date">
                                <read_only />
                            </attribute>
                            <attribute id="last_review">
                                <read_only />
                            </attribute>
                            <attribute id="next_review">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions />
                    </state>
                </states>
            </lifecycle>
            <event_listeners>
                <event_listener id="EvtSetInitialISMSControlAttributeFlags">
                    <event>EVENT_DB_SET_INITIAL_ATTRIBUTES_FLAGS</event>
                    <rank>10</rank>
                    <callback>EvtSetInitialISMSControlAttributeFlags</callback>
                </event_listener>
                <event_listener id="EvtSetISMSControlAttributeFlags">
                    <event>EVENT_DB_SET_ATTRIBUTES_FLAGS</event>
                    <rank>10</rank>
                    <callback>EvtSetISMSControlAttributeFlags</callback>
                </event_listener>
                <event_listener id="EvtBeforeISMSControlWrite">
                    <event>EVENT_DB_BEFORE_WRITE</event>
                    <rank>10</rank>
                    <callback>EvtBeforeISMSControlWrite</callback>
                </event_listener>
            </event_listeners>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="col:col0">
                            <rank>10</rank>
                            <items>
                                <item id="fieldset:ISMSControl:Basics">
                                    <rank>10</rank>
                                    <items>
                                        <item id="name">
                                            <rank>10</rank>
                                        </item>
                                        <item id="org_id">
                                            <rank>20</rank>
                                        </item>
                                        <item id="status">
                                            <rank>30</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSControl:Classification">
                                    <rank>20</rank>
                                    <items>
                                        <item id="control_domain">
                                            <rank>10</rank>
                                        </item>
                                        <item id="control_type">
                                            <rank>20</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="col:col1">
                            <rank>20</rank>
                            <items>
                                <item id="fieldset:ISMSControl:OwnershipSchedule">
                                    <rank>10</rank>
                                    <items>
                                        <item id="controlowner_id">
                                            <rank>10</rank>
                                        </item>
                                        <item id="creation_date">
                                            <rank>20</rank>
                                        </item>
                                        <item id="last_update">
                                            <rank>30</rank>
                                        </item>
                                        <item id="approval_date">
                                            <rank>40</rank>
                                        </item>
                                        <item id="implementation_date">
                                            <rank>50</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSControl:Description">
                                    <rank>20</rank>
                                    <items>
                                        <item id="description">
                                            <rank>10</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="fieldset:ISMSReview:Reviews">
                            <rank>30</rank>
                            <items>
                                <item id="review_interval_months">
                                    <rank>10</rank>
                                </item>
                                <item id="last_review">
                                    <rank>20</rank>
                                </item>
                                <item id="next_review">
                                    <rank>30</rank>
                                </item>
                            </items>
                        </item>
                        <item id="risks_list">
                            <rank>100</rank>
                        </item>
                        <item id="reviews_list">
                            <rank>110</rank>
                        </item>
                        <item id="soaentries_list">
                            <rank>120</rank>
                        </item>
                    </items>
                </details>
                <default_search>
                    <items>
                        <item id="ref">
                            <rank>10</rank>
                        </item>
                        <item id="name">
                            <rank>20</rank>
                        </item>
                        <item id="controlowner_id">
                            <rank>30</rank>
                        </item>
                        <item id="status">
                            <rank>40</rank>
                        </item>
                        <item id="org_id">
                            <rank>50</rank>
                        </item>
                    </items>
                </default_search>
                <search>
                    <items>
                        <item id="org_id">
                            <rank>10</rank>
                        </item>
                        <item id="status">
                            <rank>20</rank>
                        </item>
                        <item id="controlowner_id">
                            <rank>30</rank>
                        </item>
                        <item id="control_domain">
                            <rank>40</rank>
                        </item>
                        <item id="control_type">
                            <rank>50</rank>
                        </item>
                        <item id="implementation_date">
                            <rank>60</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="org_id">
                            <rank>20</rank>
                        </item>
                        <item id="status">
                            <rank>30</rank>
                        </item>
                        <item id="controlowner_id">
                            <rank>40</rank>
                        </item>
                        <item id="control_domain">
                            <rank>50</rank>
                        </item>
                        <item id="control_type">
                            <rank>60</rank>
                        </item>
                    </items>
                </list>
            </presentation>
        </class>
        <class id="lnkISMSRiskToISMSControl" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <properties>
                <is_link>1</is_link>
                <category>bizmodel</category>
                <abstract>false</abstract>
                <key_type>autoincrement</key_type>
                <db_table>lnkismsrisktoismscontrol</db_table>
                <db_key_field>id</db_key_field>
                <naming>
                    <attributes>
                        <attribute id="risk_id" />
                        <attribute id="control_id" />
                    </attributes>
                </naming>
                <indexes>
                    <index id="risk_id">
                        <attributes>
                            <attribute id="risk_id" />
                        </attributes>
                    </index>
                    <index id="control_id">
                        <attributes>
                            <attribute id="control_id" />
                        </attributes>
                    </index>
                    <index id="risk_control">
                        <attributes>
                            <attribute id="risk_id" />
                            <attribute id="control_id" />
                        </attributes>
                    </index>
                </indexes>
                <reconciliation>
                    <attributes>
                        <attribute id="risk_id" />
                        <attribute id="control_id" />
                    </attributes>
                </reconciliation>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="risk_id" />
                            <attribute id="control_id" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
            </properties>
            <fields>
                <field id="risk_id" xsi:type="AttributeExternalKey">
                    <sql>risk_id</sql>
                    <target_class>ISMSRisk</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                </field>
                <field id="risk_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>risk_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="risk_ref" xsi:type="AttributeExternalField">
                    <extkey_attcode>risk_id</extkey_attcode>
                    <target_attcode>ref</target_attcode>
                </field>
                <field id="control_id" xsi:type="AttributeExternalKey">
                    <sql>control_id</sql>
                    <target_class>ISMSControl</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                </field>
                <field id="control_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>control_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="effect_on_likelihood" xsi:type="AttributeEnum">
                    <sql>effect_on_likelihood</sql>
                    <values>
                        <value id="0">
                            <code>0</code>
                            <rank>10</rank>
                        </value>
                        <value id="1">
                            <code>1</code>
                            <rank>20</rank>
                        </value>
                        <value id="2">
                            <code>2</code>
                            <rank>30</rank>
                        </value>
                        <value id="3">
                            <code>3</code>
                            <rank>40</rank>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <is_null_allowed>true</is_null_allowed>
                    <display_style>radio_horizontal</display_style>
                </field>
                <field id="effect_on_impact" xsi:type="AttributeEnum">
                    <sql>effect_on_impact</sql>
                    <values>
                        <value id="0">
                            <code>0</code>
                            <rank>10</rank>
                        </value>
                        <value id="1">
                            <code>1</code>
                            <rank>20</rank>
                        </value>
                        <value id="2">
                            <code>2</code>
                            <rank>30</rank>
                        </value>
                        <value id="3">
                            <code>3</code>
                            <rank>40</rank>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <is_null_allowed>true</is_null_allowed>
                    <display_style>radio_horizontal</display_style>
                </field>
                <field id="link_status" xsi:type="AttributeEnum">
                    <sql>link_status</sql>
                    <values>
                        <value id="planned">
                            <code>planned</code>
                            <rank>10</rank>
                        </value>
                        <value id="in_progress">
                            <code>in_progress</code>
                            <rank>20</rank>
                        </value>
                        <value id="effective">
                            <code>effective</code>
                            <rank>30</rank>
                        </value>
                        <value id="ineffective">
                            <code>ineffective</code>
                            <rank>40</rank>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <default_value>planned</default_value>
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="due_date" xsi:type="AttributeDate">
                    <sql>due_date</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="comment" xsi:type="AttributeText">
                    <sql>comment</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="control_status" xsi:type="AttributeExternalField">
                    <extkey_attcode>control_id</extkey_attcode>
                    <target_attcode>status</target_attcode>
                </field>
                <field id="control_domain_ro" xsi:type="AttributeExternalField">
                    <extkey_attcode>control_id</extkey_attcode>
                    <target_attcode>control_domain</target_attcode>
                </field>
                <field id="control_type_ro" xsi:type="AttributeExternalField">
                    <extkey_attcode>control_id</extkey_attcode>
                    <target_attcode>control_type</target_attcode>
                </field>
                <field id="control_org_ro" xsi:type="AttributeExternalField">
                    <extkey_attcode>control_id</extkey_attcode>
                    <target_attcode>organization_name</target_attcode>
                </field>
                <field id="control_owner_ro" xsi:type="AttributeExternalField">
                    <extkey_attcode>control_id</extkey_attcode>
                    <target_attcode>controlowner_name</target_attcode>
                </field>
                <field id="risk_pre_level_ro" xsi:type="AttributeExternalField">
                    <extkey_attcode>risk_id</extkey_attcode>
                    <target_attcode>pre_level</target_attcode>
                </field>
                <field id="risk_pre_score_ro" xsi:type="AttributeExternalField">
                    <extkey_attcode>risk_id</extkey_attcode>
                    <target_attcode>pre_score</target_attcode>
                </field>
                <field id="risk_res_level_ro" xsi:type="AttributeExternalField">
                    <extkey_attcode>risk_id</extkey_attcode>
                    <target_attcode>res_level</target_attcode>
                </field>
                <field id="risk_res_score_ro" xsi:type="AttributeExternalField">
                    <extkey_attcode>risk_id</extkey_attcode>
                    <target_attcode>res_score</target_attcode>
                </field>
            </fields>
            <event_listeners />
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="col:col0">
                            <rank>10</rank>
                            <items>
                                <item id="fieldset:lnkISMSRiskToISMSControl:Link">
                                    <rank>10</rank>
                                    <items>
                                        <item id="risk_id">
                                            <rank>10</rank>
                                        </item>
                                        <item id="control_id">
                                            <rank>20</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:lnkISMSRiskToISMSControl:ControlSnapshot">
                                    <rank>20</rank>
                                    <items>
                                        <item id="control_status">
                                            <rank>10</rank>
                                        </item>
                                        <item id="control_domain_ro">
                                            <rank>20</rank>
                                        </item>
                                        <item id="control_type_ro">
                                            <rank>30</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:lnkISMSRiskToISMSControl:RiskSnapshot">
                                    <rank>30</rank>
                                    <items>
                                        <item id="risk_pre_level_ro">
                                            <rank>10</rank>
                                        </item>
                                        <item id="risk_pre_score_ro">
                                            <rank>20</rank>
                                        </item>
                                        <item id="risk_res_level_ro">
                                            <rank>30</rank>
                                        </item>
                                        <item id="risk_res_score_ro">
                                            <rank>40</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="col:col1">
                            <rank>20</rank>
                            <items>
                                <item id="fieldset:lnkISMSRiskToISMSControl:Effect">
                                    <rank>10</rank>
                                    <items>
                                        <item id="link_status">
                                            <rank>10</rank>
                                        </item>
                                        <item id="effect_on_likelihood">
                                            <rank>20</rank>
                                        </item>
                                        <item id="effect_on_impact">
                                            <rank>30</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:lnkISMSRiskToISMSControl:Dates">
                                    <rank>20</rank>
                                    <items>
                                        <item id="due_date">
                                            <rank>10</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="fieldset:lnkISMSRiskToISMSControl:Notes">
                            <rank>30</rank>
                            <items>
                                <item id="comment">
                                    <rank>10</rank>
                                </item>
                            </items>
                        </item>
                    </items>
                </details>
                <search>
                    <items>
                        <item id="risk_id">
                            <rank>10</rank>
                        </item>
                        <item id="control_id">
                            <rank>20</rank>
                        </item>
                        <item id="link_status">
                            <rank>30</rank>
                        </item>
                        <item id="effect_on_likelihood">
                            <rank>40</rank>
                        </item>
                        <item id="effect_on_impact">
                            <rank>50</rank>
                        </item>
                        <item id="due_date">
                            <rank>60</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="link_status">
                            <rank>20</rank>
                        </item>
                        <item id="due_date">
                            <rank>30</rank>
                        </item>
                        <item id="effect_on_likelihood">
                            <rank>40</rank>
                        </item>
                        <item id="effect_on_impact">
                            <rank>50</rank>
                        </item>
                    </items>
                </list>
            </presentation>
        </class>
        <class id="ISMSReview" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <php_parent>
                <name>BR_isms\Extension\Framework\Model\_ISMSReview</name>
                <file>src/_ISMSReview.php</file>
            </php_parent>
            <properties>
                <abstract>true</abstract>
                <category>bizmodel,searchable</category>
                <db_table>ismsreview</db_table>
                <db_key_field>id</db_key_field>
                <key_type>autoincrement</key_type>
                <naming>
                    <attributes>
                        <attribute id="status" />
                        <attribute id="planned_on" />
                    </attributes>
                </naming>
                <indexes>
                    <index id="status">
                        <attributes>
                            <attribute id="status" />
                        </attributes>
                    </index>
                    <index id="planned_on">
                        <attributes>
                            <attribute id="planned_on" />
                        </attributes>
                    </index>
                    <index id="reviewer_id">
                        <attributes>
                            <attribute id="reviewer_id" />
                        </attributes>
                    </index>
                </indexes>
                <fields_semantic>
                    <state_attribute>status</state_attribute>
                </fields_semantic>
            </properties>
            <fields>
                <field id="status" xsi:type="AttributeEnum">
                    <sql>status</sql>
                    <values>
                        <value id="planned">
                            <code>planned</code>
                            <rank>10</rank>
                            <style>
                                <main_color>$ibo-lifecycle-new-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-new-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-plus-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="in_progress">
                            <code>in_progress</code>
                            <rank>20</rank>
                            <style>
                                <main_color>$ibo-lifecycle-waiting-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-waiting-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-question-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="completed">
                            <code>completed</code>
                            <rank>30</rank>
                            <style>
                                <main_color>$ibo-lifecycle-success-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-success-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-check-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="cancelled">
                            <code>cancelled</code>
                            <rank>40</rank>
                            <style>
                                <main_color>$ibo-lifecycle-failure-state-primary-color</main_color>
                                <complementary_color>$ibo-lifecycle-failure-state-secondary-color</complementary_color>
                                <decoration_classes>fas fa-times-circle</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <default_value>planned</default_value>
                    <is_null_allowed>false</is_null_allowed>
                    <display_style>list</display_style>
                </field>
                <field id="planned_on" xsi:type="AttributeDate">
                    <sql>planned_on</sql>
                    <default_value />
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="started_on" xsi:type="AttributeDate">
                    <sql>started_on</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="completed_on" xsi:type="AttributeDate">
                    <sql>completed_on</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="reviewer_id" xsi:type="AttributeExternalKey">
                    <sql>reviewer_id</sql>
                    <target_class>Person</target_class>
                    <is_null_allowed>true</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="reviewer_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>reviewer_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="outcome" xsi:type="AttributeEnum">
                    <sql>outcome</sql>
                    <values>
                        <value id="pass">
                            <code>pass</code>
                            <rank>10</rank>
                            <style>
                                <main_color>$ibo-color-green-800</main_color>
                                <complementary_color>$ibo-color-white-100</complementary_color>
                                <decoration_classes>fas fa-check-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="minor_issues">
                            <code>minor_issues</code>
                            <rank>20</rank>
                            <style>
                                <main_color>$ibo-color-orange-800</main_color>
                                <complementary_color>$ibo-color-white-100</complementary_color>
                                <decoration_classes>fas fa-question-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="major_issues">
                            <code>major_issues</code>
                            <rank>30</rank>
                            <style>
                                <main_color>$ibo-color-pink-800</main_color>
                                <complementary_color>$ibo-color-white-100</complementary_color>
                                <decoration_classes>fas fa-question-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="fail">
                            <code>fail</code>
                            <rank>40</rank>
                            <style>
                                <main_color>$ibo-color-red-800</main_color>
                                <complementary_color>$ibo-color-white-100</complementary_color>
                                <decoration_classes>fas fa-times-circle</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <is_null_allowed>true</is_null_allowed>
                    <sort_type>rank</sort_type>
                    <display_style>list</display_style>
                </field>
                <field id="summary" xsi:type="AttributeString">
                    <sql>summary</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="scope" xsi:type="AttributeString">
                    <sql>scope</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="checklist" xsi:type="AttributeText">
                    <sql>checklist</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="evidence" xsi:type="AttributeText">
                    <sql>evidence</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="notes" xsi:type="AttributeCaseLog">
                    <sql>notes</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
            </fields>
            <lifecycle>
                <stimuli>
                    <stimulus id="ev_start" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_complete" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_cancel" xsi:type="StimulusUserAction" />
                </stimuli>
                <states>
                    <state id="planned">
                        <flags>
                            <attribute id="reviewer_id">
                                <mandatory />
                            </attribute>
                            <attribute id="planned_on">
                                <mandatory />
                            </attribute>
                            <attribute id="started_on">
                                <hidden />
                            </attribute>
                            <attribute id="completed_on">
                                <hidden />
                            </attribute>
                            <attribute id="outcome">
                                <read_only />
                            </attribute>
                            <attribute id="summary">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_start">
                                <target>in_progress</target>
                                <actions>
                                    <action id="1">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">started_on</param>
                                        </params>
                                    </action>
                                </actions>
                            </transition>
                            <transition id="ev_cancel">
                                <target>cancelled</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="in_progress">
                        <flags>
                            <attribute id="planned_on">
                                <read_only />
                            </attribute>
                            <attribute id="started_on">
                                <read_only />
                            </attribute>
                            <attribute id="completed_on">
                                <hidden />
                            </attribute>
                            <attribute id="reviewer_id">
                                <must_prompt />
                                <mandatory />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_complete">
                                <target>completed</target>
                                <flags>
                                    <attribute id="outcome">
                                        <must_prompt />
                                        <mandatory />
                                    </attribute>
                                    <attribute id="summary">
                                        <must_prompt />
                                        <mandatory />
                                    </attribute>
                                </flags>
                                <actions>
                                    <action id="1">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">completed_on</param>
                                        </params>
                                    </action>
                                </actions>
                            </transition>
                            <transition id="ev_cancel">
                                <target>cancelled</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="completed">
                        <flags>
                            <attribute id="planned_on">
                                <read_only />
                            </attribute>
                            <attribute id="started_on">
                                <read_only />
                            </attribute>
                            <attribute id="completed_on">
                                <read_only />
                            </attribute>
                            <attribute id="reviewer_id">
                                <read_only />
                            </attribute>
                            <attribute id="outcome">
                                <read_only />
                            </attribute>
                            <attribute id="summary">
                                <read_only />
                            </attribute>
                            <attribute id="notes">
                                <read_only />
                            </attribute>
                            <attribute id="scope">
                                <read_only />
                            </attribute>
                            <attribute id="checklist">
                                <read_only />
                            </attribute>
                            <attribute id="evidence">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions />
                    </state>
                    <state id="cancelled">
                        <flags>
                            <attribute id="planned_on">
                                <read_only />
                            </attribute>
                            <attribute id="started_on">
                                <read_only />
                            </attribute>
                            <attribute id="completed_on">
                                <read_only />
                            </attribute>
                            <attribute id="reviewer_id">
                                <read_only />
                            </attribute>
                            <attribute id="outcome">
                                <read_only />
                            </attribute>
                            <attribute id="summary">
                                <read_only />
                            </attribute>
                            <attribute id="notes">
                                <read_only />
                            </attribute>
                            <attribute id="scope">
                                <read_only />
                            </attribute>
                            <attribute id="checklist">
                                <read_only />
                            </attribute>
                            <attribute id="evidence">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions />
                    </state>
                </states>
            </lifecycle>
            <event_listeners>
                <event_listener id="EvtReviewCheckToWrite">
                    <event>EVENT_DB_CHECK_TO_WRITE</event>
                    <rank>10</rank>
                    <callback>EvtReviewCheckToWrite</callback>
                </event_listener>
            </event_listeners>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="status">
                            <rank>20</rank>
                        </item>
                        <item id="planned_on">
                            <rank>30</rank>
                        </item>
                        <item id="started_on">
                            <rank>40</rank>
                        </item>
                        <item id="completed_on">
                            <rank>50</rank>
                        </item>
                        <item id="reviewer_id">
                            <rank>60</rank>
                        </item>
                        <item id="outcome">
                            <rank>70</rank>
                        </item>
                        <item id="summary">
                            <rank>80</rank>
                        </item>
                        <item id="scope">
                            <rank>90</rank>
                        </item>
                        <item id="checklist">
                            <rank>100</rank>
                        </item>
                        <item id="evidence">
                            <rank>110</rank>
                        </item>
                    </items>
                </details>
                <list>
                    <items>
                        <item id="status">
                            <rank>30</rank>
                        </item>
                        <item id="planned_on">
                            <rank>40</rank>
                        </item>
                        <item id="started_on">
                            <rank>50</rank>
                        </item>
                        <item id="completed_on">
                            <rank>60</rank>
                        </item>
                        <item id="outcome">
                            <rank>70</rank>
                        </item>
                        <item id="reviewer_id">
                            <rank>80</rank>
                        </item>
                    </items>
                </list>
            </presentation>
        </class>
        <class id="ISMSAssetReview" _delta="define">
            <parent>ISMSReview</parent>
            <php_parent>
                <name>BR_isms\Extension\Framework\Model\_ISMSAssetReview</name>
                <file>src/_ISMSAssetReview.php</file>
            </php_parent>
            <properties>
                <category>bizmodel,searchable</category>
                <db_table>ismsassetreview</db_table>
                <naming>
                    <attributes>
                        <attribute id="asset_ref" />
                        <attribute id="asset_name" />
                        <attribute id="planned_on" />
                    </attributes>
                </naming>
                <indexes>
                    <index id="asset_id">
                        <attributes>
                            <attribute id="asset_id" />
                        </attributes>
                    </index>
                </indexes>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="asset_id" />
                            <attribute id="planned_on" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
                <fields_semantic>
                    <state_attribute>status</state_attribute>
                </fields_semantic>
            </properties>
            <fields>
                <field id="asset_id" xsi:type="AttributeExternalKey">
                    <sql>asset_id</sql>
                    <target_class>ISMSAsset</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="asset_ref" xsi:type="AttributeExternalField">
                    <extkey_attcode>asset_id</extkey_attcode>
                    <target_attcode>ref</target_attcode>
                </field>
                <field id="asset_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>asset_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
            </fields>
            <lifecycle>
                <stimuli>
                    <stimulus id="ev_start" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_complete" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_cancel" xsi:type="StimulusUserAction" />
                </stimuli>
                <states>
                    <state id="planned">
                        <flags>
                            <attribute id="asset_id">
                                <mandatory />
                            </attribute>
                            <attribute id="reviewer_id">
                                <mandatory />
                            </attribute>
                            <attribute id="planned_on">
                                <mandatory />
                            </attribute>
                            <attribute id="started_on">
                                <hidden />
                            </attribute>
                            <attribute id="completed_on">
                                <hidden />
                            </attribute>
                            <attribute id="outcome">
                                <read_only />
                            </attribute>
                            <attribute id="summary">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_start">
                                <target>in_progress</target>
                                <actions>
                                    <action id="1">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">started_on</param>
                                        </params>
                                    </action>
                                </actions>
                            </transition>
                            <transition id="ev_cancel">
                                <target>cancelled</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="in_progress">
                        <flags>
                            <attribute id="asset_id">
                                <read_only />
                            </attribute>
                            <attribute id="planned_on">
                                <read_only />
                            </attribute>
                            <attribute id="started_on">
                                <read_only />
                            </attribute>
                            <attribute id="completed_on">
                                <hidden />
                            </attribute>
                            <attribute id="reviewer_id">
                                <must_prompt />
                                <mandatory />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_complete">
                                <target>completed</target>
                                <flags>
                                    <attribute id="outcome">
                                        <must_prompt />
                                        <mandatory />
                                    </attribute>
                                    <attribute id="summary">
                                        <must_prompt />
                                        <mandatory />
                                    </attribute>
                                </flags>
                                <actions>
                                    <action id="1">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">completed_on</param>
                                        </params>
                                    </action>
                                </actions>
                            </transition>
                            <transition id="ev_cancel">
                                <target>cancelled</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="completed">
                        <flags>
                            <attribute id="asset_id">
                                <read_only />
                            </attribute>
                            <attribute id="planned_on">
                                <read_only />
                            </attribute>
                            <attribute id="started_on">
                                <read_only />
                            </attribute>
                            <attribute id="completed_on">
                                <read_only />
                            </attribute>
                            <attribute id="reviewer_id">
                                <read_only />
                            </attribute>
                            <attribute id="outcome">
                                <read_only />
                            </attribute>
                            <attribute id="summary">
                                <read_only />
                            </attribute>
                            <attribute id="notes">
                                <read_only />
                            </attribute>
                            <attribute id="scope">
                                <read_only />
                            </attribute>
                            <attribute id="checklist">
                                <read_only />
                            </attribute>
                            <attribute id="evidence">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions />
                    </state>
                    <state id="cancelled">
                        <flags>
                            <attribute id="asset_id">
                                <read_only />
                            </attribute>
                            <attribute id="planned_on">
                                <read_only />
                            </attribute>
                            <attribute id="started_on">
                                <read_only />
                            </attribute>
                            <attribute id="completed_on">
                                <read_only />
                            </attribute>
                            <attribute id="reviewer_id">
                                <read_only />
                            </attribute>
                            <attribute id="outcome">
                                <read_only />
                            </attribute>
                            <attribute id="summary">
                                <read_only />
                            </attribute>
                            <attribute id="notes">
                                <read_only />
                            </attribute>
                            <attribute id="scope">
                                <read_only />
                            </attribute>
                            <attribute id="checklist">
                                <read_only />
                            </attribute>
                            <attribute id="evidence">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions />
                    </state>
                </states>
            </lifecycle>
            <event_listeners>
                <event_listener id="EvtAssetReviewCheckToWrite">
                    <event>EVENT_DB_CHECK_TO_WRITE</event>
                    <rank>20</rank>
                    <callback>EvtAssetReviewCheckToWrite</callback>
                </event_listener>
                <event_listener id="EvtAssetReviewAfterWrite">
                    <event>EVENT_DB_AFTER_WRITE</event>
                    <rank>20</rank>
                    <callback>EvtAssetReviewAfterWrite</callback>
                </event_listener>
            </event_listeners>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="col:col0">
                            <rank>10</rank>
                            <items>
                                <item id="fieldset:ISMSReview:Link">
                                    <rank>10</rank>
                                    <items>
                                        <item id="asset_id">
                                            <rank>10</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSReview:Outcome">
                                    <rank>20</rank>
                                    <items>
                                        <item id="outcome">
                                            <rank>10</rank>
                                        </item>
                                        <item id="summary">
                                            <rank>20</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSReview:Notes">
                                    <rank>30</rank>
                                    <items>
                                        <item id="scope">
                                            <rank>10</rank>
                                        </item>
                                        <item id="checklist">
                                            <rank>20</rank>
                                        </item>
                                        <item id="evidence">
                                            <rank>30</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="col:col1">
                            <rank>20</rank>
                            <items>
                                <item id="fieldset:ISMSReview:Progress">
                                    <rank>10</rank>
                                    <items>
                                        <item id="status">
                                            <rank>10</rank>
                                        </item>
                                        <item id="reviewer_id">
                                            <rank>20</rank>
                                        </item>
                                        <item id="planned_on">
                                            <rank>30</rank>
                                        </item>
                                        <item id="started_on">
                                            <rank>40</rank>
                                        </item>
                                        <item id="completed_on">
                                            <rank>50</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                    </items>
                </details>
                <default_search>
                    <items>
                        <item id="asset_id">
                            <rank>10</rank>
                        </item>
                        <item id="status">
                            <rank>20</rank>
                        </item>
                        <item id="planned_on">
                            <rank>30</rank>
                        </item>
                        <item id="completed_on">
                            <rank>40</rank>
                        </item>
                        <item id="outcome">
                            <rank>50</rank>
                        </item>
                        <item id="reviewer_id">
                            <rank>60</rank>
                        </item>
                    </items>
                </default_search>
                <search>
                    <items>
                        <item id="asset_id">
                            <rank>10</rank>
                        </item>
                        <item id="status">
                            <rank>20</rank>
                        </item>
                        <item id="planned_on">
                            <rank>30</rank>
                        </item>
                        <item id="started_on">
                            <rank>40</rank>
                        </item>
                        <item id="completed_on">
                            <rank>50</rank>
                        </item>
                        <item id="outcome">
                            <rank>60</rank>
                        </item>
                        <item id="reviewer_id">
                            <rank>70</rank>
                        </item>
                        <item id="summary">
                            <rank>80</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="asset_id">
                            <rank>20</rank>
                        </item>
                        <item id="status">
                            <rank>30</rank>
                        </item>
                        <item id="planned_on">
                            <rank>40</rank>
                        </item>
                        <item id="started_on">
                            <rank>50</rank>
                        </item>
                        <item id="completed_on">
                            <rank>60</rank>
                        </item>
                        <item id="outcome">
                            <rank>70</rank>
                        </item>
                        <item id="reviewer_id">
                            <rank>80</rank>
                        </item>
                    </items>
                </list>
            </presentation>
        </class>
        <class id="ISMSRiskReview" _delta="define">
            <parent>ISMSReview</parent>
            <php_parent>
                <name>BR_isms\Extension\Framework\Model\_ISMSRiskReview</name>
                <file>src/_ISMSRiskReview.php</file>
            </php_parent>
            <properties>
                <category>bizmodel,searchable</category>
                <db_table>ismsriskreview</db_table>
                <naming>
                    <attributes>
                        <attribute id="risk_ref" />
                        <attribute id="risk_name" />
                        <attribute id="planned_on" />
                    </attributes>
                </naming>
                <indexes>
                    <index id="risk_id">
                        <attributes>
                            <attribute id="risk_id" />
                        </attributes>
                    </index>
                </indexes>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="risk_id" />
                            <attribute id="planned_on" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
                <fields_semantic>
                    <state_attribute>status</state_attribute>
                </fields_semantic>
            </properties>
            <fields>
                <field id="risk_id" xsi:type="AttributeExternalKey">
                    <sql>risk_id</sql>
                    <target_class>ISMSRisk</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="risk_ref" xsi:type="AttributeExternalField">
                    <extkey_attcode>risk_id</extkey_attcode>
                    <target_attcode>ref</target_attcode>
                </field>
                <field id="risk_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>risk_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
            </fields>
            <lifecycle>
                <stimuli>
                    <stimulus id="ev_start" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_complete" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_cancel" xsi:type="StimulusUserAction" />
                </stimuli>
                <states>
                    <state id="planned">
                        <flags>
                            <attribute id="risk_id">
                                <mandatory />
                            </attribute>
                            <attribute id="reviewer_id">
                                <mandatory />
                            </attribute>
                            <attribute id="planned_on">
                                <mandatory />
                            </attribute>
                            <attribute id="started_on">
                                <hidden />
                            </attribute>
                            <attribute id="completed_on">
                                <hidden />
                            </attribute>
                            <attribute id="outcome">
                                <read_only />
                            </attribute>
                            <attribute id="summary">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_start">
                                <target>in_progress</target>
                                <actions>
                                    <action id="1">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">started_on</param>
                                        </params>
                                    </action>
                                </actions>
                            </transition>
                            <transition id="ev_cancel">
                                <target>cancelled</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="in_progress">
                        <flags>
                            <attribute id="risk_id">
                                <read_only />
                            </attribute>
                            <attribute id="planned_on">
                                <read_only />
                            </attribute>
                            <attribute id="started_on">
                                <read_only />
                            </attribute>
                            <attribute id="completed_on">
                                <hidden />
                            </attribute>
                            <attribute id="reviewer_id">
                                <must_prompt />
                                <mandatory />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_complete">
                                <target>completed</target>
                                <flags>
                                    <attribute id="outcome">
                                        <must_prompt />
                                        <mandatory />
                                    </attribute>
                                    <attribute id="summary">
                                        <must_prompt />
                                        <mandatory />
                                    </attribute>
                                </flags>
                                <actions>
                                    <action id="1">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">completed_on</param>
                                        </params>
                                    </action>
                                </actions>
                            </transition>
                            <transition id="ev_cancel">
                                <target>cancelled</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="completed">
                        <flags>
                            <attribute id="risk_id">
                                <read_only />
                            </attribute>
                            <attribute id="planned_on">
                                <read_only />
                            </attribute>
                            <attribute id="started_on">
                                <read_only />
                            </attribute>
                            <attribute id="completed_on">
                                <read_only />
                            </attribute>
                            <attribute id="reviewer_id">
                                <read_only />
                            </attribute>
                            <attribute id="outcome">
                                <read_only />
                            </attribute>
                            <attribute id="summary">
                                <read_only />
                            </attribute>
                            <attribute id="notes">
                                <read_only />
                            </attribute>
                            <attribute id="scope">
                                <read_only />
                            </attribute>
                            <attribute id="checklist">
                                <read_only />
                            </attribute>
                            <attribute id="evidence">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions />
                    </state>
                    <state id="cancelled">
                        <flags>
                            <attribute id="risk_id">
                                <read_only />
                            </attribute>
                            <attribute id="planned_on">
                                <read_only />
                            </attribute>
                            <attribute id="started_on">
                                <read_only />
                            </attribute>
                            <attribute id="completed_on">
                                <read_only />
                            </attribute>
                            <attribute id="reviewer_id">
                                <read_only />
                            </attribute>
                            <attribute id="outcome">
                                <read_only />
                            </attribute>
                            <attribute id="summary">
                                <read_only />
                            </attribute>
                            <attribute id="notes">
                                <read_only />
                            </attribute>
                            <attribute id="scope">
                                <read_only />
                            </attribute>
                            <attribute id="checklist">
                                <read_only />
                            </attribute>
                            <attribute id="evidence">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions />
                    </state>
                </states>
            </lifecycle>
            <event_listeners>
                <event_listener id="EvtRiskReviewCheckToWrite">
                    <event>EVENT_DB_CHECK_TO_WRITE</event>
                    <rank>20</rank>
                    <callback>EvtRiskReviewCheckToWrite</callback>
                </event_listener>
                <event_listener id="EvtRiskReviewAfterWrite">
                    <event>EVENT_DB_AFTER_WRITE</event>
                    <rank>20</rank>
                    <callback>EvtRiskReviewAfterWrite</callback>
                </event_listener>
            </event_listeners>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="col:col0">
                            <rank>10</rank>
                            <items>
                                <item id="fieldset:ISMSReview:Link">
                                    <rank>10</rank>
                                    <items>
                                        <item id="risk_id">
                                            <rank>10</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSReview:Outcome">
                                    <rank>20</rank>
                                    <items>
                                        <item id="outcome">
                                            <rank>10</rank>
                                        </item>
                                        <item id="summary">
                                            <rank>20</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSReview:Notes">
                                    <rank>30</rank>
                                    <items>
                                        <item id="scope">
                                            <rank>10</rank>
                                        </item>
                                        <item id="checklist">
                                            <rank>20</rank>
                                        </item>
                                        <item id="evidence">
                                            <rank>30</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="col:col1">
                            <rank>20</rank>
                            <items>
                                <item id="fieldset:ISMSReview:Progress">
                                    <rank>10</rank>
                                    <items>
                                        <item id="status">
                                            <rank>10</rank>
                                        </item>
                                        <item id="reviewer_id">
                                            <rank>20</rank>
                                        </item>
                                        <item id="planned_on">
                                            <rank>30</rank>
                                        </item>
                                        <item id="started_on">
                                            <rank>40</rank>
                                        </item>
                                        <item id="completed_on">
                                            <rank>50</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                    </items>
                </details>
                <default_search>
                    <items>
                        <item id="risk_id">
                            <rank>10</rank>
                        </item>
                        <item id="status">
                            <rank>20</rank>
                        </item>
                        <item id="planned_on">
                            <rank>30</rank>
                        </item>
                        <item id="completed_on">
                            <rank>40</rank>
                        </item>
                        <item id="outcome">
                            <rank>50</rank>
                        </item>
                        <item id="reviewer_id">
                            <rank>60</rank>
                        </item>
                    </items>
                </default_search>
                <search>
                    <items>
                        <item id="risk_id">
                            <rank>10</rank>
                        </item>
                        <item id="status">
                            <rank>20</rank>
                        </item>
                        <item id="planned_on">
                            <rank>30</rank>
                        </item>
                        <item id="started_on">
                            <rank>40</rank>
                        </item>
                        <item id="completed_on">
                            <rank>50</rank>
                        </item>
                        <item id="outcome">
                            <rank>60</rank>
                        </item>
                        <item id="reviewer_id">
                            <rank>70</rank>
                        </item>
                        <item id="summary">
                            <rank>80</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="risk_id">
                            <rank>20</rank>
                        </item>
                        <item id="status">
                            <rank>30</rank>
                        </item>
                        <item id="planned_on">
                            <rank>40</rank>
                        </item>
                        <item id="started_on">
                            <rank>50</rank>
                        </item>
                        <item id="completed_on">
                            <rank>60</rank>
                        </item>
                        <item id="outcome">
                            <rank>70</rank>
                        </item>
                        <item id="reviewer_id">
                            <rank>80</rank>
                        </item>
                    </items>
                </list>
            </presentation>
        </class>
        <class id="ISMSControlReview" _delta="define">
            <parent>ISMSReview</parent>
            <php_parent>
                <name>BR_isms\Extension\Framework\Model\_ISMSControlReview</name>
                <file>src/_ISMSControlReview.php</file>
            </php_parent>
            <properties>
                <category>bizmodel,searchable</category>
                <db_table>ismscontrolreview</db_table>
                <naming>
                    <attributes>
                        <attribute id="control_ref" />
                        <attribute id="control_name" />
                        <attribute id="planned_on" />
                    </attributes>
                </naming>
                <indexes>
                    <index id="control_id">
                        <attributes>
                            <attribute id="control_id" />
                        </attributes>
                    </index>
                </indexes>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="control_id" />
                            <attribute id="planned_on" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
                <fields_semantic>
                    <state_attribute>status</state_attribute>
                </fields_semantic>
            </properties>
            <fields>
                <field id="control_id" xsi:type="AttributeExternalKey">
                    <sql>control_id</sql>
                    <target_class>ISMSControl</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="control_ref" xsi:type="AttributeExternalField">
                    <extkey_attcode>control_id</extkey_attcode>
                    <target_attcode>ref</target_attcode>
                </field>
                <field id="control_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>control_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
            </fields>
            <lifecycle>
                <stimuli>
                    <stimulus id="ev_start" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_complete" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_cancel" xsi:type="StimulusUserAction" />
                </stimuli>
                <states>
                    <state id="planned">
                        <flags>
                            <attribute id="control_id">
                                <mandatory />
                            </attribute>
                            <attribute id="reviewer_id">
                                <mandatory />
                            </attribute>
                            <attribute id="planned_on">
                                <mandatory />
                            </attribute>
                            <attribute id="started_on">
                                <hidden />
                            </attribute>
                            <attribute id="completed_on">
                                <hidden />
                            </attribute>
                            <attribute id="outcome">
                                <read_only />
                            </attribute>
                            <attribute id="summary">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_start">
                                <target>in_progress</target>
                                <actions>
                                    <action id="1">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">started_on</param>
                                        </params>
                                    </action>
                                </actions>
                            </transition>
                            <transition id="ev_cancel">
                                <target>cancelled</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="in_progress">
                        <flags>
                            <attribute id="control_id">
                                <read_only />
                            </attribute>
                            <attribute id="planned_on">
                                <read_only />
                            </attribute>
                            <attribute id="started_on">
                                <read_only />
                            </attribute>
                            <attribute id="completed_on">
                                <hidden />
                            </attribute>
                            <attribute id="reviewer_id">
                                <must_prompt />
                                <mandatory />
                            </attribute>
                        </flags>
                        <transitions>
                            <transition id="ev_complete">
                                <target>completed</target>
                                <flags>
                                    <attribute id="outcome">
                                        <must_prompt />
                                        <mandatory />
                                    </attribute>
                                    <attribute id="summary">
                                        <must_prompt />
                                        <mandatory />
                                    </attribute>
                                </flags>
                                <actions>
                                    <action id="1">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">completed_on</param>
                                        </params>
                                    </action>
                                </actions>
                            </transition>
                            <transition id="ev_cancel">
                                <target>cancelled</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="completed">
                        <flags>
                            <attribute id="control_id">
                                <read_only />
                            </attribute>
                            <attribute id="planned_on">
                                <read_only />
                            </attribute>
                            <attribute id="started_on">
                                <read_only />
                            </attribute>
                            <attribute id="completed_on">
                                <read_only />
                            </attribute>
                            <attribute id="reviewer_id">
                                <read_only />
                            </attribute>
                            <attribute id="outcome">
                                <read_only />
                            </attribute>
                            <attribute id="summary">
                                <read_only />
                            </attribute>
                            <attribute id="notes">
                                <read_only />
                            </attribute>
                            <attribute id="scope">
                                <read_only />
                            </attribute>
                            <attribute id="checklist">
                                <read_only />
                            </attribute>
                            <attribute id="evidence">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions />
                    </state>
                    <state id="cancelled">
                        <flags>
                            <attribute id="control_id">
                                <read_only />
                            </attribute>
                            <attribute id="planned_on">
                                <read_only />
                            </attribute>
                            <attribute id="started_on">
                                <read_only />
                            </attribute>
                            <attribute id="completed_on">
                                <read_only />
                            </attribute>
                            <attribute id="reviewer_id">
                                <read_only />
                            </attribute>
                            <attribute id="outcome">
                                <read_only />
                            </attribute>
                            <attribute id="summary">
                                <read_only />
                            </attribute>
                            <attribute id="notes">
                                <read_only />
                            </attribute>
                            <attribute id="scope">
                                <read_only />
                            </attribute>
                            <attribute id="checklist">
                                <read_only />
                            </attribute>
                            <attribute id="evidence">
                                <read_only />
                            </attribute>
                        </flags>
                        <transitions />
                    </state>
                </states>
            </lifecycle>
            <event_listeners>
                <event_listener id="EvtControlReviewCheckToWrite">
                    <event>EVENT_DB_CHECK_TO_WRITE</event>
                    <rank>20</rank>
                    <callback>EvtControlReviewCheckToWrite</callback>
                </event_listener>
                <event_listener id="EvtControlReviewAfterWrite">
                    <event>EVENT_DB_AFTER_WRITE</event>
                    <rank>20</rank>
                    <callback>EvtControlReviewAfterWrite</callback>
                </event_listener>
            </event_listeners>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="col:col0">
                            <rank>10</rank>
                            <items>
                                <item id="fieldset:ISMSReview:Link">
                                    <rank>10</rank>
                                    <items>
                                        <item id="control_id">
                                            <rank>10</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSReview:Outcome">
                                    <rank>20</rank>
                                    <items>
                                        <item id="outcome">
                                            <rank>10</rank>
                                        </item>
                                        <item id="summary">
                                            <rank>20</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSReview:Notes">
                                    <rank>30</rank>
                                    <items>
                                        <item id="scope">
                                            <rank>10</rank>
                                        </item>
                                        <item id="checklist">
                                            <rank>20</rank>
                                        </item>
                                        <item id="evidence">
                                            <rank>30</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="col:col1">
                            <rank>20</rank>
                            <items>
                                <item id="fieldset:ISMSReview:Progress">
                                    <rank>10</rank>
                                    <items>
                                        <item id="status">
                                            <rank>10</rank>
                                        </item>
                                        <item id="reviewer_id">
                                            <rank>20</rank>
                                        </item>
                                        <item id="planned_on">
                                            <rank>30</rank>
                                        </item>
                                        <item id="started_on">
                                            <rank>40</rank>
                                        </item>
                                        <item id="completed_on">
                                            <rank>50</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                    </items>
                </details>
                <default_search>
                    <items>
                        <item id="control_id">
                            <rank>10</rank>
                        </item>
                        <item id="status">
                            <rank>20</rank>
                        </item>
                        <item id="planned_on">
                            <rank>30</rank>
                        </item>
                        <item id="completed_on">
                            <rank>40</rank>
                        </item>
                        <item id="outcome">
                            <rank>50</rank>
                        </item>
                        <item id="reviewer_id">
                            <rank>60</rank>
                        </item>
                    </items>
                </default_search>
                <search>
                    <items>
                        <item id="control_id">
                            <rank>10</rank>
                        </item>
                        <item id="status">
                            <rank>20</rank>
                        </item>
                        <item id="planned_on">
                            <rank>30</rank>
                        </item>
                        <item id="started_on">
                            <rank>40</rank>
                        </item>
                        <item id="completed_on">
                            <rank>50</rank>
                        </item>
                        <item id="outcome">
                            <rank>60</rank>
                        </item>
                        <item id="reviewer_id">
                            <rank>70</rank>
                        </item>
                        <item id="summary">
                            <rank>80</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="control_id">
                            <rank>20</rank>
                        </item>
                        <item id="status">
                            <rank>30</rank>
                        </item>
                        <item id="planned_on">
                            <rank>40</rank>
                        </item>
                        <item id="started_on">
                            <rank>50</rank>
                        </item>
                        <item id="completed_on">
                            <rank>60</rank>
                        </item>
                        <item id="outcome">
                            <rank>70</rank>
                        </item>
                        <item id="reviewer_id">
                            <rank>80</rank>
                        </item>
                    </items>
                </list>
            </presentation>
        </class>
        <!-- Standards and SoA -->
        <class id="ISMSStandard" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <properties>
                <category>bizmodel,searchable</category>
                <db_table>ismsstandard</db_table>
                <db_key_field>id</db_key_field>
                <key_type>autoincrement</key_type>
                <naming>
                    <attributes>
                        <attribute id="name" />
                        <attribute id="version" />
                    </attributes>
                </naming>
                <reconciliation>
                    <attributes>
                        <attribute id="name" />
                        <attribute id="version" />
                    </attributes>
                </reconciliation>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="name" />
                            <attribute id="version" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
            </properties>
            <fields>
                <field id="name" xsi:type="AttributeString">
                    <sql>name</sql>
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="version" xsi:type="AttributeString">
                    <sql>version</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="publisher" xsi:type="AttributeString">
                    <sql>publisher</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="url" xsi:type="AttributeURL">
                    <sql>url</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="controls_list" xsi:type="AttributeLinkedSet">
                    <linked_class>ISMSStandardControl</linked_class>
                    <ext_key_to_me>standard_id</ext_key_to_me>
                </field>
            </fields>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="name" />
                        <item id="version" />
                        <item id="publisher" />
                        <item id="url" />
                        <item id="controls_list" />
                    </items>
                </details>
                <default_search>
                    <items>
                        <item id="name" />
                        <item id="version" />
                    </items>
                </default_search>
                <search>
                    <items>
                        <item id="name" />
                        <item id="version" />
                        <item id="publisher" />
                    </items>
                </search>
                <list>
                    <items>
                        <item id="name" />
                        <item id="version" />
                        <item id="publisher" />
                    </items>
                </list>
                <summary>
                    <items>
                        <item id="publisher">
                            <rank>10</rank>
                        </item>
                        <item id="url">
                            <rank>20</rank>
                        </item>
                    </items>
                </summary>
            </presentation>
        </class>
        <class id="ISMSStandardControl" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <properties>
                <category>bizmodel,searchable</category>
                <db_table>ismsstandardcontrol</db_table>
                <db_key_field>id</db_key_field>
                <key_type>autoincrement</key_type>
                <naming>
                    <attributes>
                        <attribute id="standard_name" />
                        <attribute id="standard_version" />
                        <attribute id="code" />
                        <attribute id="title" />
                    </attributes>
                </naming>
                <reconciliation>
                    <attributes>
                        <attribute id="code" />
                        <attribute id="title" />
                    </attributes>
                </reconciliation>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="standard_id" />
                            <attribute id="code" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
            </properties>
            <fields>
                <field id="standard_id" xsi:type="AttributeExternalKey">
                    <sql>standard_id</sql>
                    <target_class>ISMSStandard</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="standard_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>standard_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="standard_version" xsi:type="AttributeExternalField">
                    <extkey_attcode>standard_id</extkey_attcode>
                    <target_attcode>version</target_attcode>
                </field>
                <field id="code" xsi:type="AttributeString">
                    <sql>code</sql>
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="title" xsi:type="AttributeString">
                    <sql>title</sql>
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="domain" xsi:type="AttributeString">
                    <sql>domain</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="description" xsi:type="AttributeText">
                    <sql>description</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
            </fields>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="standard_id" />
                        <item id="code" />
                        <item id="title" />
                        <item id="domain" />
                        <item id="description" />
                    </items>
                </details>
                <default_search>
                    <items>
                        <item id="standard_id" />
                        <item id="code" />
                        <item id="title" />
                        <item id="domain" />
                    </items>
                </default_search>
                <search>
                    <items>
                        <item id="standard_id" />
                        <item id="code" />
                        <item id="title" />
                        <item id="domain" />
                    </items>
                </search>
                <list>
                    <items>
                        <item id="standard_id" />
                        <item id="code" />
                        <item id="title" />
                        <item id="domain" />
                    </items>
                </list>
                <summary>
                    <items>
                        <item id="domain">
                            <rank>10</rank>
                        </item>
                    </items>
                </summary>
            </presentation>
        </class>
        <class id="ISMSSoA" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <php_parent>
                <name>BR_isms\Extension\Framework\Model\_ISMSSoA</name>
                <file>src/_ISMSSoA.php</file>
            </php_parent>
            <properties>
                <category>bizmodel,searchable</category>
                <db_table>ismssao</db_table>
                <db_key_field>id</db_key_field>
                <key_type>autoincrement</key_type>
                <naming>
                    <attributes>
                        <attribute id="org_name" />
                        <attribute id="standard_name" />
                        <attribute id="standard_version" />
                    </attributes>
                </naming>
                <fields_semantic>
                    <state_attribute>status</state_attribute>
                </fields_semantic>
                <reconciliation>
                    <attributes>
                        <attribute id="org_id" />
                        <attribute id="org_name" />
                        <attribute id="standard_id" />
                        <attribute id="standard_name" />
                        <attribute id="standard_version" />
                    </attributes>
                </reconciliation>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="org_id" />
                            <attribute id="standard_id" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
                <obsolescence>
                    <condition><![CDATA[status='obsolete']]></condition>
                </obsolescence>
            </properties>
            <fields>
                <field id="org_id" xsi:type="AttributeExternalKey">
                    <sql>org_id</sql>
                    <target_class>Organization</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                </field>
                <field id="org_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>org_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="standard_id" xsi:type="AttributeExternalKey">
                    <sql>standard_id</sql>
                    <target_class>ISMSStandard</target_class>
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="standard_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>standard_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="standard_version" xsi:type="AttributeExternalField">
                    <extkey_attcode>standard_id</extkey_attcode>
                    <target_attcode>version</target_attcode>
                </field>
                <field id="status" xsi:type="AttributeEnum">
                    <sql>status</sql>
                    <values>
                        <value id="draft">
                            <code>draft</code>
                            <rank>10</rank>
                        </value>
                        <value id="in_review">
                            <code>in_review</code>
                            <rank>20</rank>
                        </value>
                        <value id="approved">
                            <code>approved</code>
                            <rank>30</rank>
                        </value>
                        <value id="obsolete">
                            <code>obsolete</code>
                            <rank>40</rank>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <default_value>draft</default_value>
                    <is_null_allowed>false</is_null_allowed>
                    <always_load_in_tables>true</always_load_in_tables>
                    <display_style>list</display_style>
                </field>
                <field id="owner_id" xsi:type="AttributeExternalKey">
                    <sql>owner_id</sql>
                    <target_class>Person</target_class>
                    <filter><![CDATA[SELECT Person WHERE org_id = :this->org_id]]></filter>
                    <dependencies>
                        <attribute id="org_id" />
                    </dependencies>
                    <is_null_allowed>true</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                </field>
                <field id="owner_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>owner_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="effective_from" xsi:type="AttributeDate">
                    <sql>effective_from</sql>
                    <default_value />
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="notes" xsi:type="AttributeCaseLog">
                    <sql>notes</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="kpi_total" xsi:type="AttributeInteger">
                    <sql>kpi_total</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="kpi_applicable" xsi:type="AttributeInteger">
                    <sql>kpi_applicable</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="kpi_implemented" xsi:type="AttributeInteger">
                    <sql>kpi_implemented</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="kpi_gaps" xsi:type="AttributeInteger">
                    <sql>kpi_gaps</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="soaentries_list" xsi:type="AttributeLinkedSet">
                    <linked_class>ISMSSoAEntry</linked_class>
                    <ext_key_to_me>soa_id</ext_key_to_me>
                </field>
            </fields>
            <lifecycle>
                <stimuli>
                    <stimulus id="ev_submit" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_approve" xsi:type="StimulusUserAction" />
                    <stimulus id="ev_obsolete" xsi:type="StimulusUserAction" />
                </stimuli>
                <states>
                    <state id="draft">
                        <flags />
                        <transitions>
                            <transition id="ev_submit">
                                <target>in_review</target>
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="in_review">
                        <flags />
                        <transitions>
                            <transition id="ev_approve">
                                <target>approved</target>
                                <actions>
                                    <action id="1">
                                        <verb>SetCurrentDate</verb>
                                        <params>
                                            <param xsi:type="attcode">effective_from</param>
                                        </params>
                                    </action>
                                </actions>
                            </transition>
                        </transitions>
                    </state>
                    <state id="approved">
                        <flags />
                        <transitions>
                            <transition id="ev_obsolete">
                                <target>obsolete</target>
                                <flags />
                                <actions />
                            </transition>
                        </transitions>
                    </state>
                    <state id="obsolete">
                        <flags />
                        <transitions />
                    </state>
                </states>
            </lifecycle>
            <event_listeners>
                <event_listener id="EvtSetInitialISMSoAAttributeFlags">
                    <event>EVENT_DB_SET_INITIAL_ATTRIBUTES_FLAGS</event>
                    <rank>10</rank>
                    <callback>EvtSetInitialISMSoAAttributeFlags</callback>
                </event_listener>
                <event_listener id="EvtSetISMSSoaAttributeFlags">
                    <event>EVENT_DB_SET_ATTRIBUTES_FLAGS</event>
                    <rank>10</rank>
                    <callback>EvtSetISMSSoaAttributeFlags</callback>
                </event_listener>
                <event_listener id="EvtISMSSoAComputeValues">
                    <event>EVENT_DB_COMPUTE_VALUES</event>
                    <rank>10</rank>
                    <callback>EvtISMSSoAComputeValues</callback>
                </event_listener>
                <event_listener id="EvtISMSSoACheckToWrite">
                    <event>EVENT_DB_CHECK_TO_WRITE</event>
                    <rank>10</rank>
                    <callback>EvtISMSSoACheckToWrite</callback>
                </event_listener>
                <event_listener id="EvtISMSSoAAfterWrite">
                    <event>EVENT_DB_AFTER_WRITE</event>
                    <rank>10</rank>
                    <callback>EvtISMSSoAAfterWrite</callback>
                </event_listener>
            </event_listeners>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="col:col0">
                            <rank>10</rank>
                            <items>
                                <!-- Header / Basics -->
                                <item id="fieldset:ISMSSoA:Header">
                                    <rank>10</rank>
                                    <items>
                                        <item id="org_id">
                                            <rank>10</rank>
                                        </item>
                                        <item id="standard_id">
                                            <rank>20</rank>
                                        </item>
                                        <item id="status">
                                            <rank>30</rank>
                                        </item>
                                        <item id="owner_id">
                                            <rank>40</rank>
                                        </item>
                                        <item id="effective_from">
                                            <rank>50</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="col:col1">
                            <rank>20</rank>
                            <items>
                                <item id="fieldset:ISMSSoA:KPIs">
                                    <rank>10</rank>
                                    <items>
                                        <item id="kpi_total">
                                            <rank>10</rank>
                                        </item>
                                        <item id="kpi_applicable">
                                            <rank>20</rank>
                                        </item>
                                        <item id="kpi_implemented">
                                            <rank>30</rank>
                                        </item>
                                        <item id="kpi_gaps">
                                            <rank>40</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="soaentries_list">
                            <rank>100</rank>
                        </item>
                    </items>
                </details>
                <default_search>
                    <items>
                        <item id="org_id">
                            <rank>10</rank>
                        </item>
                        <item id="standard_id">
                            <rank>20</rank>
                        </item>
                        <item id="status">
                            <rank>30</rank>
                        </item>
                        <item id="owner_id">
                            <rank>40</rank>
                        </item>
                    </items>
                </default_search>
                <search>
                    <items>
                        <item id="org_id">
                            <rank>10</rank>
                        </item>
                        <item id="standard_id">
                            <rank>20</rank>
                        </item>
                        <item id="status">
                            <rank>30</rank>
                        </item>
                        <item id="owner_id">
                            <rank>40</rank>
                        </item>
                        <item id="effective_from">
                            <rank>50</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="org_id">
                            <rank>10</rank>
                        </item>
                        <item id="standard_id">
                            <rank>20</rank>
                        </item>
                        <item id="status">
                            <rank>30</rank>
                        </item>
                        <item id="kpi_total">
                            <rank>40</rank>
                        </item>
                        <item id="kpi_applicable">
                            <rank>50</rank>
                        </item>
                        <item id="kpi_implemented">
                            <rank>60</rank>
                        </item>
                        <item id="kpi_gaps">
                            <rank>70</rank>
                        </item>
                    </items>
                </list>
                <summary>
                    <items>
                        <item id="org_id">
                            <rank>10</rank>
                        </item>
                        <item id="standard_id">
                            <rank>20</rank>
                        </item>
                        <item id="owner_id">
                            <rank>30</rank>
                        </item>
                    </items>
                </summary>
            </presentation>
        </class>
        <class id="ISMSSoAEntry" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <php_parent>
                <name>BR_isms\Extension\Framework\Model\_ISMSSoAEntry</name>
                <file>src/_ISMSSoAEntry.php</file>
            </php_parent>
            <properties>
                <category>bizmodel,searchable</category>
                <db_table>ismssaoentry</db_table>
                <db_key_field>id</db_key_field>
                <key_type>autoincrement</key_type>
                <naming>
                    <attributes>
                        <attribute id="soa_org_name" />
                        <attribute id="soa_standard_name" />
                        <attribute id="standardcontrol_code" />
                    </attributes>
                </naming>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="soa_id" />
                            <attribute id="standardcontrol_code" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
            </properties>
            <fields>
                <field id="soa_id" xsi:type="AttributeExternalKey">
                    <sql>soa_id</sql>
                    <target_class>ISMSSoA</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                </field>
                <field id="soa_org_id" xsi:type="AttributeExternalField">
                    <extkey_attcode>soa_id</extkey_attcode>
                    <target_attcode>org_id</target_attcode>
                </field>
                <field id="soa_org_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>soa_id</extkey_attcode>
                    <target_attcode>org_name</target_attcode>
                </field>
                <field id="soa_standard_id" xsi:type="AttributeExternalField">
                    <extkey_attcode>soa_id</extkey_attcode>
                    <target_attcode>standard_id</target_attcode>
                </field>
                <field id="soa_standard_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>soa_id</extkey_attcode>
                    <target_attcode>standard_name</target_attcode>
                </field>
                <field id="standardcontrol_id" xsi:type="AttributeExternalKey">
                    <sql>standardcontrol_id</sql>
                    <target_class>ISMSStandardControl</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                </field>
                <field id="standardcontrol_code" xsi:type="AttributeExternalField">
                    <extkey_attcode>standardcontrol_id</extkey_attcode>
                    <target_attcode>code</target_attcode>
                </field>
                <field id="standardcontrol_title" xsi:type="AttributeExternalField">
                    <extkey_attcode>standardcontrol_id</extkey_attcode>
                    <target_attcode>title</target_attcode>
                </field>
                <field id="standardcontrol_domain" xsi:type="AttributeExternalField">
                    <extkey_attcode>standardcontrol_id</extkey_attcode>
                    <target_attcode>domain</target_attcode>
                </field>
                <field id="applicability" xsi:type="AttributeEnum">
                    <sql>applicability</sql>
                    <values>
                        <value id="applicable">
                            <code>applicable</code>
                            <rank>10</rank>
                            <style>
                                <main_color>rgb(232,245,233)</main_color>
                                <complementary_color>rgb(27,94,32)</complementary_color>
                                <decoration_classes>fas fa-check-circle</decoration_classes>
                            </style>
                        </value>
                        <value id="not_applicable">
                            <code>not_applicable</code>
                            <rank>20</rank>
                            <style>
                                <main_color>rgb(238,238,238)</main_color>
                                <complementary_color>rgb(85,85,85)</complementary_color>
                                <decoration_classes>fas fa-ban</decoration_classes>
                            </style>
                        </value>
                        <value id="partial">
                            <code>partial</code>
                            <rank>30</rank>
                            <style>
                                <main_color>rgb(255,243,205)</main_color>
                                <complementary_color>rgb(102,60,0)</complementary_color>
                                <decoration_classes>fas fa-adjust</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <default_value>not_applicable</default_value>
                    <is_null_allowed>false</is_null_allowed>
                    <always_load_in_tables>true</always_load_in_tables>
                    <display_style>radio_horizontal</display_style>
                </field>
                <field id="justification" xsi:type="AttributeText">
                    <sql>justification</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="implementation_status" xsi:type="AttributeEnum">
                    <sql>impl_status</sql>
                    <values>
                        <value id="planned">
                            <code>planned</code>
                            <rank>10</rank>
                            <style>
                                <main_color>rgb(227,242,253)</main_color>
                                <complementary_color>rgb(13,71,161)</complementary_color>
                                <decoration_classes>fas fa-calendar-plus</decoration_classes>
                            </style>
                        </value>
                        <value id="in_progress">
                            <code>in_progress</code>
                            <rank>20</rank>
                            <style>
                                <main_color>rgb(187,222,251)</main_color>
                                <complementary_color>rgb(21,101,192)</complementary_color>
                                <decoration_classes>fas fa-spinner</decoration_classes>
                            </style>
                        </value>
                        <value id="implemented">
                            <code>implemented</code>
                            <rank>30</rank>
                            <style>
                                <main_color>rgb(232,245,233)</main_color>
                                <complementary_color>rgb(27,94,32)</complementary_color>
                                <decoration_classes>fas fa-check</decoration_classes>
                            </style>
                        </value>
                        <value id="not_implemented">
                            <code>not_implemented</code>
                            <rank>40</rank>
                            <style>
                                <main_color>rgb(255,235,238)</main_color>
                                <complementary_color>rgb(183,28,28)</complementary_color>
                                <decoration_classes>fas fa-triangle-exclamation</decoration_classes>
                            </style>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <default_value>not_implemented</default_value>
                    <is_null_allowed>false</is_null_allowed>
                    <display_style>list</display_style>
                </field>
                <field id="evidence" xsi:type="AttributeText">
                    <sql>evidence</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="notes" xsi:type="AttributeCaseLog">
                    <sql>notes</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="controls_list" xsi:type="AttributeLinkedSetIndirect">
                    <linked_class>lnkISMSSoAEntryToISMSControl</linked_class>
                    <ext_key_to_me>soaentry_id</ext_key_to_me>
                    <ext_key_to_remote>control_id</ext_key_to_remote>
                </field>
            </fields>
            <event_listeners>
                <event_listener id="EvtISMSSoAEntryCheckToWrite">
                    <event>EVENT_DB_CHECK_TO_WRITE</event>
                    <rank>10</rank>
                    <callback>EvtISMSSoAEntryCheckToWrite</callback>
                </event_listener>
            </event_listeners>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="col:col0">
                            <rank>10</rank>
                            <items>
                                <item id="fieldset:ISMSSoAEntry:Link">
                                    <rank>10</rank>
                                    <items>
                                        <item id="soa_id">
                                            <rank>10</rank>
                                        </item>
                                        <item id="standardcontrol_id">
                                            <rank>20</rank>
                                        </item>
                                        <item id="standardcontrol_domain">
                                            <rank>50</rank>
                                        </item>
                                    </items>
                                </item>
                                <item id="fieldset:ISMSSoAEntry:Decision">
                                    <rank>20</rank>
                                    <items>
                                        <item id="applicability">
                                            <rank>10</rank>
                                        </item>
                                        <item id="justification">
                                            <rank>20</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="col:col1">
                            <rank>20</rank>
                            <items>
                                <item id="fieldset:ISMSSoAEntry:Implementation">
                                    <rank>10</rank>
                                    <items>
                                        <item id="implementation_status">
                                            <rank>10</rank>
                                        </item>
                                        <item id="evidence">
                                            <rank>20</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="controls_list">
                            <rank>100</rank>
                        </item>
                    </items>
                </details>
                <default_search>
                    <items>
                        <item id="soa_id">
                            <rank>10</rank>
                        </item>
                        <item id="standardcontrol_code">
                            <rank>20</rank>
                        </item>
                        <item id="standardcontrol_title">
                            <rank>30</rank>
                        </item>
                        <item id="applicability">
                            <rank>40</rank>
                        </item>
                        <item id="implementation_status">
                            <rank>50</rank>
                        </item>
                        <item id="standardcontrol_domain">
                            <rank>60</rank>
                        </item>
                    </items>
                </default_search>
                <search>
                    <items>
                        <item id="soa_org_id">
                            <rank>10</rank>
                        </item>
                        <item id="soa_standard_id">
                            <rank>20</rank>
                        </item>
                        <item id="soa_id">
                            <rank>30</rank>
                        </item>
                        <item id="standardcontrol_id">
                            <rank>40</rank>
                        </item>
                        <item id="standardcontrol_code">
                            <rank>50</rank>
                        </item>
                        <item id="standardcontrol_title">
                            <rank>60</rank>
                        </item>
                        <item id="standardcontrol_domain">
                            <rank>70</rank>
                        </item>
                        <item id="applicability">
                            <rank>80</rank>
                        </item>
                        <item id="implementation_status">
                            <rank>90</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="soa_id">
                            <rank>20</rank>
                        </item>
                        <item id="standardcontrol_id">
                            <rank>30</rank>
                        </item>
                        <item id="standardcontrol_code">
                            <rank>40</rank>
                        </item>
                        <item id="standardcontrol_title">
                            <rank>50</rank>
                        </item>
                        <item id="standardcontrol_domain">
                            <rank>60</rank>
                        </item>
                        <item id="applicability">
                            <rank>70</rank>
                        </item>
                        <item id="implementation_status">
                            <rank>80</rank>
                        </item>
                    </items>
                </list>
                <summary>
                    <items>
                        <item id="applicability" />
                        <item id="implementation_status" />
                        <item id="standardcontrol_code" />
                        <item id="standardcontrol_domain" />
                    </items>
                </summary>
            </presentation>
        </class>
        <class id="lnkISMSSoAEntryToISMSControl" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <properties>
                <is_link>1</is_link>
                <category>bizmodel</category>
                <db_table>lnksoaentrytocontrol</db_table>
                <key_type>autoincrement</key_type>
                <db_key_field>id</db_key_field>
                <naming>
                    <attributes>
                        <attribute id="soaentry_id" />
                        <attribute id="control_name" />
                    </attributes>
                </naming>
                <reconciliation>
                    <attributes>
                        <attribute id="soaentry_id" />
                        <attribute id="control_id" />
                        <attribute id="control_name" />
                    </attributes>
                </reconciliation>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="soaentry_id" />
                            <attribute id="control_id" />
                        </attributes>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
            </properties>
            <fields>
                <field id="soaentry_id" xsi:type="AttributeExternalKey">
                    <sql>soaentry_id</sql>
                    <target_class>ISMSSoAEntry</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                </field>
                <field id="control_id" xsi:type="AttributeExternalKey">
                    <sql>control_id</sql>
                    <target_class>ISMSControl</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                </field>
                <field id="control_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>control_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="role" xsi:type="AttributeString">
                    <sql>role</sql>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="contribution" xsi:type="AttributeEnum">
                    <sql>contrib</sql>
                    <values>
                        <value id="primary">
                            <code>primary</code>
                            <rank>10</rank>
                        </value>
                        <value id="supporting">
                            <code>supporting</code>
                            <rank>20</rank>
                        </value>
                    </values>
                    <sort_type>rank</sort_type>
                    <is_null_allowed>true</is_null_allowed>
                    <display_style>radio_horizontal</display_style>
                </field>
            </fields>
            <methods />
            <presentation>
                <details>
                    <items>
                        <item id="soaentry_id" />
                        <item id="control_id" />
                        <item id="role" />
                        <item id="contribution" />
                    </items>
                </details>
                <list>
                    <items>
                        <item id="soaentry_id" />
                        <item id="control_id" />
                    </items>
                </list>
            </presentation>
        </class>
    </classes>
    <!-- ***************** Menus ***************** -->
    <menus>
        <menu id="ISMSManagement" xsi:type="MenuGroup" _delta="define">
            <rank>29</rank>
            <enable_class>ISMSAsset</enable_class>
            <enable_admin_only>0</enable_admin_only>
            <enable_action>UR_ACTION_READ</enable_action>
            <style>
                <decoration_classes>fas fa-table</decoration_classes>
            </style>
        </menu>
        <menu id="ISMSSpace" xsi:type="DashboardMenuNode" _delta="define">
            <rank>0</rank>
            <parent>ISMSManagement</parent>
            <enable_class>ISMSAsset</enable_class>
            <enable_action>UR_ACTION_READ</enable_action>
            <definition>
                <layout>DashboardLayoutOneCol</layout>
                <title />
                <cells>
                    <cell id="isms-100">
                        <rank>1</rank>
                        <dashlets>
                            <dashlet id="isms-101" xsi:type="DashletHeaderStatic">
                                <rank>101</rank>
                                <title>Menu:ISMSSpace:Assets</title>
                            </dashlet>
                            <dashlet id="isms-110" xsi:type="DashletBadge">
                                <rank>110</rank>
                                <class>ISMSAsset</class>
                            </dashlet>
                            <dashlet id="isms-120" xsi:type="DashletBadge">
                                <rank>120</rank>
                                <class>ISMSAssetType</class>
                            </dashlet>
                        </dashlets>
                    </cell>
                    <cell id="isms-200">
                        <rank>2</rank>
                        <dashlets>
                            <dashlet id="isms-201" xsi:type="DashletHeaderStatic">
                                <rank>1</rank>
                                <title>Menu:ISMSSpace:Risks</title>
                            </dashlet>
                            <dashlet id="isms-210" xsi:type="DashletBadge">
                                <rank>210</rank>
                                <class>ISMSRisk</class>
                            </dashlet>
                            <dashlet id="isms-220" xsi:type="DashletBadge">
                                <rank>220</rank>
                                <class>ISMSControl</class>
                            </dashlet>
                        </dashlets>
                    </cell>
                    <cell id="isms-300">
                        <rank>3</rank>
                        <dashlets>
                            <dashlet id="isms-301" xsi:type="DashletHeaderStatic">
                                <rank>301</rank>
                                <title>Menu:ISMSSpace:Reviews</title>
                            </dashlet>
                            <dashlet id="isms-310" xsi:type="DashletBadge">
                                <rank>310</rank>
                                <class>ISMSReview</class>
                            </dashlet>
                            <dashlet id="isms-320" xsi:type="DashletBadge">
                                <rank>320</rank>
                                <class>ISMSAssetReview</class>
                            </dashlet>
                            <dashlet id="isms-330" xsi:type="DashletBadge">
                                <rank>330</rank>
                                <class>ISMSRiskReview</class>
                            </dashlet>
                            <dashlet id="isms-340" xsi:type="DashletBadge">
                                <rank>340</rank>
                                <class>ISMSControlReview</class>
                            </dashlet>
                        </dashlets>
                    </cell>
                    <cell id="isms-400">
                        <rank>4</rank>
                        <dashlets>
                            <dashlet id="isms-401" xsi:type="DashletHeaderStatic">
                                <rank>401</rank>
                                <title>Menu:ISMSSpace:Standards</title>
                            </dashlet>
                            <dashlet id="isms-410" xsi:type="DashletBadge">
                                <rank>410</rank>
                                <class>ISMSStandard</class>
                            </dashlet>
                            <dashlet id="isms-420" xsi:type="DashletBadge">
                                <rank>420</rank>
                                <class>ISMSStandardControl</class>
                            </dashlet>
                            <dashlet id="isms-430" xsi:type="DashletBadge">
                                <rank>430</rank>
                                <class>ISMSSoA</class>
                            </dashlet>
                            <dashlet id="isms-440" xsi:type="DashletBadge">
                                <rank>440</rank>
                                <class>ISMSSoAEntry</class>
                            </dashlet>
                        </dashlets>
                    </cell>
                </cells>
            </definition>
        </menu>
        <menu id="NewISMSAsset" xsi:type="NewObjectMenuNode" _delta="define">
            <rank>10</rank>
            <parent>ISMSManagement</parent>
            <class>ISMSAsset</class>
            <enable_class>ISMSAsset</enable_class>
            <enable_action>UR_ACTION_MODIFY</enable_action>
        </menu>
        <menu id="NewISMSRisk" xsi:type="NewObjectMenuNode" _delta="define">
            <rank>11</rank>
            <parent>ISMSManagement</parent>
            <class>ISMSRisk</class>
            <enable_class>ISMSRisk</enable_class>
            <enable_action>UR_ACTION_MODIFY</enable_action>
        </menu>
        <menu id="NewISMSControl" xsi:type="NewObjectMenuNode" _delta="define">
            <rank>12</rank>
            <parent>ISMSManagement</parent>
            <class>ISMSControl</class>
            <enable_class>ISMSControl</enable_class>
            <enable_action>UR_ACTION_MODIFY</enable_action>
        </menu>
        <menu id="SearchISMSAssets" xsi:type="SearchMenuNode" _delta="define">
            <rank>20</rank>
            <parent>ISMSManagement</parent>
            <class>ISMSAsset</class>
            <enable_class>ISMSAsset</enable_class>
            <enable_action>UR_ACTION_READ</enable_action>
        </menu>
        <menu id="SearchISMSRisks" xsi:type="SearchMenuNode" _delta="define">
            <rank>21</rank>
            <parent>ISMSManagement</parent>
            <class>ISMSRisk</class>
            <enable_class>ISMSRisk</enable_class>
            <enable_action>UR_ACTION_READ</enable_action>
        </menu>
        <menu id="SearchISMSControls" xsi:type="SearchMenuNode" _delta="define">
            <rank>22</rank>
            <parent>ISMSManagement</parent>
            <class>ISMSControl</class>
            <enable_class>ISMSControl</enable_class>
            <enable_action>UR_ACTION_READ</enable_action>
        </menu>
        <menu id="ISMSManagement:Shortcuts" xsi:type="TemplateMenuNode" _delta="define">
            <rank>30</rank>
            <parent>ISMSManagement</parent>
            <template_file />
            <enable_class>ISMSAsset</enable_class>
            <enable_action>UR_ACTION_READ</enable_action>
        </menu>
        <menu id="ISMSMyAssets" xsi:type="OQLMenuNode" _delta="define">
            <rank>31</rank>
            <parent>ISMSManagement:Shortcuts</parent>
            <oql><![CDATA[
SELECT ISMSAsset
WHERE assetowner_id = :current_contact_id
    AND status NOT IN ("obsolete")
  ]]></oql>
            <do_search>1</do_search>
            <auto_reload>fast</auto_reload>
            <enable_class>ISMSAsset</enable_class>
            <enable_action>UR_ACTION_READ</enable_action>
        </menu>
        <menu id="ISMSMyRisks" xsi:type="OQLMenuNode" _delta="define">
            <rank>32</rank>
            <parent>ISMSManagement:Shortcuts</parent>
            <oql><![CDATA[
SELECT ISMSRisk
WHERE riskowner_id = :current_contact_id
    AND status NOT IN ("obsolete")
  ]]></oql>
            <do_search>1</do_search>
            <auto_reload>fast</auto_reload>
            <enable_class>ISMSRisk</enable_class>
            <enable_action>UR_ACTION_READ</enable_action>
        </menu>
        <menu id="ISMSMyControls" xsi:type="OQLMenuNode" _delta="define">
            <rank>32</rank>
            <parent>ISMSManagement:Shortcuts</parent>
            <oql><![CDATA[
SELECT ISMSControl
WHERE controlowner_id = :current_contact_id
    AND status NOT IN ("retired")
  ]]></oql>
            <do_search>1</do_search>
            <auto_reload>fast</auto_reload>
            <enable_class>ISMSControl</enable_class>
            <enable_action>UR_ACTION_READ</enable_action>
        </menu>
        <!-- === ISMS Dashboards & OQL-Shortcuts ===
        <menu id="ISMSManagement:Dashboards" xsi:type="TemplateMenuNode" _delta="define">
            <rank>40</rank>
            <parent>ISMSManagement</parent>
            <template_file />
            <enable_class>ISMSRisk</enable_class>
            <enable_action>UR_ACTION_READ</enable_action>
        </menu>
        <menu id="ISMSDash:RisksWithoutControls" xsi:type="OQLMenuNode" _delta="define">
            <rank>41</rank>
            <parent>ISMSManagement:Dashboards</parent>
            <oql><![CDATA[
SELECT ISMSRisk
WHERE status NOT IN ("obsolete")
    AND treatment_decision NOT IN ("accept")
    AND acceptance_status NOT IN ("accepted")
    AND id NOT IN (SELECT ISMSRisk AS r JOIN lnkISMSRiskToISMSControl AS l ON l.risk_id = r.id)
  ]]></oql>
            <do_search>1</do_search>
            <auto_reload>fast</auto_reload>
            <enable_class>ISMSRisk</enable_class>
            <enable_action>UR_ACTION_READ</enable_action>
        </menu>
        <menu id="ISMSDash:OverdueMitigations" xsi:type="OQLMenuNode" _delta="define">
            <rank>42</rank>
            <parent>ISMSManagement:Dashboards</parent>
            <oql><![CDATA[
SELECT lnkISMSRiskToISMSControl
WHERE due_date != NULL
    AND due_date < DATE(NOW())
    AND link_status IN ("planned","in_progress","ineffective")
  ]]></oql>
            <do_search>1</do_search>
            <auto_reload>fast</auto_reload>
            <enable_class>lnkISMSRiskToISMSControl</enable_class>
            <enable_action>UR_ACTION_READ</enable_action>
        </menu>
        <menu id="ISMSDash:ControlsReviewDue" xsi:type="OQLMenuNode" _delta="define">
            <rank>43</rank>
            <parent>ISMSManagement:Dashboards</parent>
            <oql><![CDATA[
SELECT ISMSControl
WHERE status NOT IN ("retired")
    AND next_review != NULL
    AND next_review < DATE(NOW())
  ]]></oql>
            <do_search>1</do_search>
            <auto_reload>fast</auto_reload>
            <enable_class>ISMSControl</enable_class>
            <enable_action>UR_ACTION_READ</enable_action>
        </menu>
        <menu id="ISMSDash:ControlsNoNextReview" xsi:type="OQLMenuNode" _delta="define">
            <rank>44</rank>
            <parent>ISMSManagement:Dashboards</parent>
            <oql><![CDATA[
SELECT ISMSControl
WHERE status NOT IN ('retired')
    AND next_review = NULL
  ]]></oql>
            <do_search>1</do_search>
            <auto_reload>fast</auto_reload>
            <enable_class>ISMSControl</enable_class>
            <enable_action>UR_ACTION_READ</enable_action>
        </menu>
        -->
    </menus>
    <user_rights>
        <groups>
            <group id="ISMSTypology" _delta="define">
                <classes>
                    <class id="ISMSAssetType" />
                </classes>
            </group>
            <group id="ISMSAssetMgmt" _delta="define">
                <classes>
                    <class id="ISMSAsset" />
                </classes>
            </group>
            <group id="ISMSRiskMgmt" _delta="define">
                <classes>
                    <class id="ISMSRisk" />
                </classes>
            </group>
            <group id="ISMSControlMgmt" _delta="define">
                <classes>
                    <class id="ISMSControl" />
                </classes>
            </group>
            <group id="ISMSLinkAssetAsset" _delta="define">
                <classes>
                    <class id="lnkSupportingAssetToAsset" />
                </classes>
            </group>
            <group id="ISMSLinkRiskAsset" _delta="define">
                <classes>
                    <class id="lnkISMSRiskToISMSAsset" />
                </classes>
            </group>
            <group id="ISMSLinkRiskControl" _delta="define">
                <classes>
                    <class id="lnkISMSRiskToISMSControl" />
                </classes>
            </group>
            <group id="ISMSAssetReview" _delta="define">
                <classes>
                    <class id="ISMSReview" />
                    <class id="ISMSAssetReview" />
                </classes>
            </group>
            <group id="ISMSRiskReview" _delta="define">
                <classes>
                    <class id="ISMSReview" />
                    <class id="ISMSRiskReview" />
                </classes>
            </group>
            <group id="ISMSControlReview" _delta="define">
                <classes>
                    <class id="ISMSReview" />
                    <class id="ISMSControlReview" />
                </classes>
            </group>
            <group id="ISMSStandardAndControl" _delta="define">
                <classes>
                    <class id="ISMSStandard" />
                    <class id="ISMSStandardControl" />
                </classes>
            </group>
            <group id="ISMSSoAAndEntry" _delta="define">
                <classes>
                    <class id="ISMSSoA" />
                    <class id="ISMSSoAEntry" />
                </classes>
            </group>
            <group id="ISMSLinkSoAEntryControl" _delta="define">
                <classes>
                    <class id="lnkISMSSoAEntryToISMSControl" />
                </classes>
            </group>
        </groups>
        <profiles>
            <profile id="117" _delta="if_exists">
                <!-- SuperUser -->
                <groups>
                    <group id="ISMSTypology" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSAssetMgmt" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                            <action id="stimulus:ev_publish">allow</action>
                            <action id="stimulus:ev_draft">allow</action>
                            <action id="stimulus:ev_obsolete">allow</action>
                            <action id="stimulus:ev_reopen">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSRiskMgmt" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                            <action id="stimulus:ev_publish">allow</action>
                            <action id="stimulus:ev_draft">allow</action>
                            <action id="stimulus:ev_obsolete">allow</action>
                            <action id="stimulus:ev_reopen">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSControlMgmt" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                            <action id="stimulus:ev_submit">allow</action>
                            <action id="stimulus:ev_approve">allow</action>
                            <action id="stimulus:ev_start_impl">allow</action>
                            <action id="stimulus:ev_mark_effective">allow</action>
                            <action id="stimulus:ev_suspend">allow</action>
                            <action id="stimulus:ev_resume">allow</action>
                            <action id="stimulus:ev_retire">allow</action>
                            <action id="stimulus:ev_start_amend">allow</action>
                            <action id="stimulus:ev_submit_amend">allow</action>
                            <action id="stimulus:ev_cancel_amend">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkAssetAsset" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkRiskAsset" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkRiskControl" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSAssetReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                            <action id="stimulus:ev_start">allow</action>
                            <action id="stimulus:ev_complete">allow</action>
                            <action id="stimulus:ev_cancel">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSRiskReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                            <action id="stimulus:ev_start">allow</action>
                            <action id="stimulus:ev_complete">allow</action>
                            <action id="stimulus:ev_cancel">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSControlReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                            <action id="stimulus:ev_start">allow</action>
                            <action id="stimulus:ev_complete">allow</action>
                            <action id="stimulus:ev_cancel">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSStandardAndControl" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSSoAAndEntry" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkSoAEntryControl" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                </groups>
            </profile>
            <profile id="73001" _delta="define">
                <name>ISMS Manager</name>
                <description>Full access to ISMS Assets, Risks, Controls, links and lifecycle actions across all organizations.</description>
                <groups>
                    <group id="ISMSTypology">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSAssetMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                            <action id="stimulus:ev_publish">allow</action>
                            <action id="stimulus:ev_draft">allow</action>
                            <action id="stimulus:ev_obsolete">allow</action>
                            <action id="stimulus:ev_reopen">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSRiskMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                            <action id="stimulus:ev_publish">allow</action>
                            <action id="stimulus:ev_draft">allow</action>
                            <action id="stimulus:ev_obsolete">allow</action>
                            <action id="stimulus:ev_reopen">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSControlMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                            <action id="stimulus:ev_submit">allow</action>
                            <action id="stimulus:ev_approve">allow</action>
                            <action id="stimulus:ev_start_impl">allow</action>
                            <action id="stimulus:ev_mark_effective">allow</action>
                            <action id="stimulus:ev_suspend">allow</action>
                            <action id="stimulus:ev_resume">allow</action>
                            <action id="stimulus:ev_retire">allow</action>
                            <action id="stimulus:ev_start_amend">allow</action>
                            <action id="stimulus:ev_submit_amend">allow</action>
                            <action id="stimulus:ev_cancel_amend">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkAssetAsset">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkRiskAsset">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkRiskControl">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSAssetReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                            <action id="stimulus:ev_start">allow</action>
                            <action id="stimulus:ev_complete">allow</action>
                            <action id="stimulus:ev_cancel">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSRiskReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                            <action id="stimulus:ev_start">allow</action>
                            <action id="stimulus:ev_complete">allow</action>
                            <action id="stimulus:ev_cancel">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSControlReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                            <action id="stimulus:ev_start">allow</action>
                            <action id="stimulus:ev_complete">allow</action>
                            <action id="stimulus:ev_cancel">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSStandardAndControl" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSSoAAndEntry" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkSoAEntryControl" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                </groups>
            </profile>
            <profile id="73002" _delta="define">
                <name>ISMS Asset Maintainer</name>
                <description>Create and maintain ISMS Assets (typically within own organization). No publish or obsolete transitions.</description>
                <groups>
                    <group id="ISMSTypology">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSAssetMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_publish">deny</action>
                            <action id="stimulus:ev_draft">deny</action>
                            <action id="stimulus:ev_obsolete">deny</action>
                            <action id="stimulus:ev_reopen">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSRiskMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_publish">deny</action>
                            <action id="stimulus:ev_draft">deny</action>
                            <action id="stimulus:ev_obsolete">deny</action>
                            <action id="stimulus:ev_reopen">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSControlMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_submit">deny</action>
                            <action id="stimulus:ev_approve">deny</action>
                            <action id="stimulus:ev_start_impl">deny</action>
                            <action id="stimulus:ev_mark_effective">deny</action>
                            <action id="stimulus:ev_suspend">deny</action>
                            <action id="stimulus:ev_resume">deny</action>
                            <action id="stimulus:ev_retire">deny</action>
                            <action id="stimulus:ev_start_amend">deny</action>
                            <action id="stimulus:ev_submit_amend">deny</action>
                            <action id="stimulus:ev_cancel_amend">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkAssetAsset">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkRiskAsset">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkRiskControl">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSAssetReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_start">allow</action>
                            <action id="stimulus:ev_complete">allow</action>
                            <action id="stimulus:ev_cancel">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSRiskReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_start">deny</action>
                            <action id="stimulus:ev_complete">deny</action>
                            <action id="stimulus:ev_cancel">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSControlReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_start">deny</action>
                            <action id="stimulus:ev_complete">deny</action>
                            <action id="stimulus:ev_cancel">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSStandardAndControl" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSSoAAndEntry" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkSoAEntryControl" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                </groups>
            </profile>
            <profile id="73003" _delta="define">
                <name>ISMS Risk Analyst</name>
                <description>Create and assess ISMS Risks, manage links to Assets/Controls and treatment data. No publish or obsolete transitions.</description>
                <groups>
                    <group id="ISMSTypology">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSAssetMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_publish">deny</action>
                            <action id="stimulus:ev_draft">deny</action>
                            <action id="stimulus:ev_obsolete">deny</action>
                            <action id="stimulus:ev_reopen">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSRiskMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_publish">deny</action>
                            <action id="stimulus:ev_draft">deny</action>
                            <action id="stimulus:ev_obsolete">deny</action>
                            <action id="stimulus:ev_reopen">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSControlMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_submit">deny</action>
                            <action id="stimulus:ev_approve">deny</action>
                            <action id="stimulus:ev_start_impl">deny</action>
                            <action id="stimulus:ev_mark_effective">deny</action>
                            <action id="stimulus:ev_suspend">deny</action>
                            <action id="stimulus:ev_resume">deny</action>
                            <action id="stimulus:ev_retire">deny</action>
                            <action id="stimulus:ev_start_amend">deny</action>
                            <action id="stimulus:ev_submit_amend">deny</action>
                            <action id="stimulus:ev_cancel_amend">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkAssetAsset">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkRiskAsset">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkRiskControl">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSAssetReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_start">deny</action>
                            <action id="stimulus:ev_complete">deny</action>
                            <action id="stimulus:ev_cancel">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSRiskReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_start">allow</action>
                            <action id="stimulus:ev_complete">allow</action>
                            <action id="stimulus:ev_cancel">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSControlReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_start">deny</action>
                            <action id="stimulus:ev_complete">deny</action>
                            <action id="stimulus:ev_cancel">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSStandardAndControl" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSSoAAndEntry" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkSoAEntryControl" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                </groups>
            </profile>
            <profile id="73004" _delta="define">
                <name>ISMS Control Maintainer</name>
                <description>Create and maintain ISMS Controls and implementation details. Governance actions (approve/effective/retire) by Manager.</description>
                <groups>
                    <group id="ISMSTypology">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSAssetMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_publish">deny</action>
                            <action id="stimulus:ev_draft">deny</action>
                            <action id="stimulus:ev_obsolete">deny</action>
                            <action id="stimulus:ev_reopen">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSRiskMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_publish">deny</action>
                            <action id="stimulus:ev_draft">deny</action>
                            <action id="stimulus:ev_obsolete">deny</action>
                            <action id="stimulus:ev_reopen">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSControlMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_submit">allow</action>
                            <action id="stimulus:ev_approve">deny</action>
                            <action id="stimulus:ev_start_impl">allow</action>
                            <action id="stimulus:ev_mark_effective">deny</action>
                            <action id="stimulus:ev_suspend">allow</action>
                            <action id="stimulus:ev_resume">allow</action>
                            <action id="stimulus:ev_retire">deny</action>
                            <action id="stimulus:ev_start_amend">allow</action>
                            <action id="stimulus:ev_submit_amend">allow</action>
                            <action id="stimulus:ev_cancel_amend">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkAssetAsset">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkRiskAsset">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkRiskControl">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSAssetReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_start">deny</action>
                            <action id="stimulus:ev_complete">deny</action>
                            <action id="stimulus:ev_cancel">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSRiskReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_start">deny</action>
                            <action id="stimulus:ev_complete">deny</action>
                            <action id="stimulus:ev_cancel">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSControlReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_start">allow</action>
                            <action id="stimulus:ev_complete">allow</action>
                            <action id="stimulus:ev_cancel">allow</action>
                        </actions>
                    </group>
                    <group id="ISMSStandardAndControl" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSSoAAndEntry" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkSoAEntryControl" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                </groups>
            </profile>
            <profile id="73005" _delta="define">
                <name>ISMS Viewer</name>
                <description>Read-only access to ISMS Assets, Risks and Controls.</description>
                <groups>
                    <group id="ISMSTypology">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSAssetMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_publish">deny</action>
                            <action id="stimulus:ev_draft">deny</action>
                            <action id="stimulus:ev_obsolete">deny</action>
                            <action id="stimulus:ev_reopen">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSRiskMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_publish">deny</action>
                            <action id="stimulus:ev_draft">deny</action>
                            <action id="stimulus:ev_obsolete">deny</action>
                            <action id="stimulus:ev_reopen">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSControlMgmt">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_submit">deny</action>
                            <action id="stimulus:ev_approve">deny</action>
                            <action id="stimulus:ev_start_impl">deny</action>
                            <action id="stimulus:ev_mark_effective">deny</action>
                            <action id="stimulus:ev_suspend">deny</action>
                            <action id="stimulus:ev_resume">deny</action>
                            <action id="stimulus:ev_retire">deny</action>
                            <action id="stimulus:ev_start_amend">deny</action>
                            <action id="stimulus:ev_submit_amend">deny</action>
                            <action id="stimulus:ev_cancel_amend">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkAssetAsset">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkRiskAsset">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkRiskControl">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSAssetReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_start">deny</action>
                            <action id="stimulus:ev_complete">deny</action>
                            <action id="stimulus:ev_cancel">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSRiskReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_start">deny</action>
                            <action id="stimulus:ev_complete">deny</action>
                            <action id="stimulus:ev_cancel">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSControlReview" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                            <action id="stimulus:ev_start">deny</action>
                            <action id="stimulus:ev_complete">deny</action>
                            <action id="stimulus:ev_cancel">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSStandardAndControl" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSSoAAndEntry" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">deny</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                    <group id="ISMSLinkSoAEntryControl" _delta="define">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                            <action id="action:write">deny</action>
                            <action id="action:bulk write">deny</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">deny</action>
                        </actions>
                    </group>
                </groups>
            </profile>
        </profiles>
    </user_rights>
    <module_parameters>
        <parameters id="br-isms" _delta="define">
            <risk_aggregation_mode type="string">max</risk_aggregation_mode>
            <review_interval_months type="integer">12</review_interval_months>
        </parameters>
    </module_parameters>
    <meta>
        <dashlets>
            <dashlet id="DashletRiskMatrix" _delta="define">
                <label>UI:DashletRiskMatrix:Label</label>
                <icon>br-isms/images/isms-risk.svg</icon>
                <description>UI:DashletRiskMatrix:Description</description>
                <configuration>
                    <title>Published Risks â Residual Matrix</title>
                    <query>SELECT ISMSRisk WHERE status = "published"</query>
                    <x_axis>res_impact</x_axis>
                    <y_axis>res_likelihood</y_axis>
                    <link>true</link>
                    <totals>true</totals>
                    <color_mode>severity</color_mode>
                    <show_percent>true</show_percent>
                    <include_na>false</include_na>
                </configuration>
            </dashlet>
        </dashlets>
    </meta>
</itop_design>
